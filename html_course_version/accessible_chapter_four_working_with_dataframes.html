<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.120">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 4 - Working with DataFrames</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="chapter_four_working_with_dataframes_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter_four_working_with_dataframes_files/libs/quarto-html/quarto.js"></script>
<script src="chapter_four_working_with_dataframes_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter_four_working_with_dataframes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chapter_four_working_with_dataframes_files/libs/quarto-html/anchor.min.js"></script>
<link href="chapter_four_working_with_dataframes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter_four_working_with_dataframes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chapter_four_working_with_dataframes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chapter_four_working_with_dataframes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chapter_four_working_with_dataframes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="chapter_four_working_with_dataframes_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="chapter_four_working_with_dataframes_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#packages-and-datasets" id="toc-packages-and-datasets" class="nav-link active" data-scroll-target="#packages-and-datasets"><span class="toc-section-number">1</span>  Packages and Datasets</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages"><span class="toc-section-number">1.1</span>  Packages</a>
  <ul class="collapse">
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="toc-section-number">1.1.1</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets"><span class="toc-section-number">1.2</span>  Datasets</a>
  <ul class="collapse">
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="toc-section-number">1.2.1</span>  Exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exploring-datasets" id="toc-exploring-datasets" class="nav-link" data-scroll-target="#exploring-datasets"><span class="toc-section-number">2</span>  Exploring Datasets</a>
  <ul class="collapse">
  <li><a href="#quick-previews" id="toc-quick-previews" class="nav-link" data-scroll-target="#quick-previews"><span class="toc-section-number">2.1</span>  Quick Previews</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="toc-section-number">2.1.1</span>  Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="toc-section-number">2.1.2</span>  Example</a></li>
  </ul></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"><span class="toc-section-number">2.2</span>  Size</a>
  <ul class="collapse">
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span class="toc-section-number">2.2.1</span>  Example</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3"><span class="toc-section-number">2.2.2</span>  Example</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="toc-section-number">2.2.3</span>  Exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-types" id="toc-data-types" class="nav-link" data-scroll-target="#data-types"><span class="toc-section-number">3</span>  Data Types</a>
  <ul class="collapse">
  <li><a href="#observing-the-datatypes-in-our-data" id="toc-observing-the-datatypes-in-our-data" class="nav-link" data-scroll-target="#observing-the-datatypes-in-our-data"><span class="toc-section-number">3.1</span>  Observing the datatypes in our data</a>
  <ul class="collapse">
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4"><span class="toc-section-number">3.1.1</span>  Example</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5"><span class="toc-section-number">3.1.2</span>  Example</a></li>
  <li><a href="#exercise-4" id="toc-exercise-4" class="nav-link" data-scroll-target="#exercise-4"><span class="toc-section-number">3.1.3</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#column-names" id="toc-column-names" class="nav-link" data-scroll-target="#column-names"><span class="toc-section-number">3.2</span>  Column Names</a>
  <ul class="collapse">
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6"><span class="toc-section-number">3.2.1</span>  Example</a></li>
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7"><span class="toc-section-number">3.2.2</span>  Example</a></li>
  <li><a href="#exercise-6" id="toc-exercise-6" class="nav-link" data-scroll-target="#exercise-6"><span class="toc-section-number">3.2.3</span>  Exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sorting-data" id="toc-sorting-data" class="nav-link" data-scroll-target="#sorting-data"><span class="toc-section-number">4</span>  Sorting Data</a>
  <ul class="collapse">
  <li><a href="#the-method-of-sorting-in-pandas" id="toc-the-method-of-sorting-in-pandas" class="nav-link" data-scroll-target="#the-method-of-sorting-in-pandas"><span class="toc-section-number">4.1</span>  The method of sorting in Pandas</a>
  <ul class="collapse">
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8"><span class="toc-section-number">4.1.1</span>  Example</a></li>
  <li><a href="#example-9" id="toc-example-9" class="nav-link" data-scroll-target="#example-9"><span class="toc-section-number">4.1.2</span>  Example</a></li>
  <li><a href="#example-10" id="toc-example-10" class="nav-link" data-scroll-target="#example-10"><span class="toc-section-number">4.1.3</span>  Example</a></li>
  <li><a href="#exercise-8" id="toc-exercise-8" class="nav-link" data-scroll-target="#exercise-8"><span class="toc-section-number">4.1.4</span>  Exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#revisiting-parameters-and-arguments" id="toc-revisiting-parameters-and-arguments" class="nav-link" data-scroll-target="#revisiting-parameters-and-arguments"><span class="toc-section-number">5</span>  Revisiting parameters and arguments</a>
  <ul class="collapse">
  <li><a href="#important-example" id="toc-important-example" class="nav-link" data-scroll-target="#important-example">Important Example</a></li>
  </ul></li>
  <li><a href="#subsetting" id="toc-subsetting" class="nav-link" data-scroll-target="#subsetting"><span class="toc-section-number">6</span>  Subsetting</a>
  <ul class="collapse">
  <li><a href="#selecting-single-columns" id="toc-selecting-single-columns" class="nav-link" data-scroll-target="#selecting-single-columns"><span class="toc-section-number">6.1</span>  Selecting Single Columns</a>
  <ul class="collapse">
  <li><a href="#example-11" id="toc-example-11" class="nav-link" data-scroll-target="#example-11"><span class="toc-section-number">6.1.1</span>  Example</a></li>
  <li><a href="#exercise-10" id="toc-exercise-10" class="nav-link" data-scroll-target="#exercise-10"><span class="toc-section-number">6.1.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#selecting-multiple-columns" id="toc-selecting-multiple-columns" class="nav-link" data-scroll-target="#selecting-multiple-columns"><span class="toc-section-number">6.2</span>  Selecting Multiple Columns</a>
  <ul class="collapse">
  <li><a href="#example-12" id="toc-example-12" class="nav-link" data-scroll-target="#example-12"><span class="toc-section-number">6.2.1</span>  Example</a></li>
  <li><a href="#exercise-12" id="toc-exercise-12" class="nav-link" data-scroll-target="#exercise-12"><span class="toc-section-number">6.2.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#selecting-on-data-type" id="toc-selecting-on-data-type" class="nav-link" data-scroll-target="#selecting-on-data-type"><span class="toc-section-number">6.3</span>  Selecting on data type</a>
  <ul class="collapse">
  <li><a href="#exercise-14" id="toc-exercise-14" class="nav-link" data-scroll-target="#exercise-14"><span class="toc-section-number">6.3.1</span>  Exercise</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="toc-section-number">7</span>  Filtering</a>
  <ul class="collapse">
  <li><a href="#filtering-by-index-position" id="toc-filtering-by-index-position" class="nav-link" data-scroll-target="#filtering-by-index-position"><span class="toc-section-number">7.1</span>  Filtering by Index Position</a>
  <ul class="collapse">
  <li><a href="#example-13" id="toc-example-13" class="nav-link" data-scroll-target="#example-13"><span class="toc-section-number">7.1.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#single-conditional-filtering" id="toc-single-conditional-filtering" class="nav-link" data-scroll-target="#single-conditional-filtering"><span class="toc-section-number">7.2</span>  Single Conditional Filtering</a>
  <ul class="collapse">
  <li><a href="#example-14" id="toc-example-14" class="nav-link" data-scroll-target="#example-14"><span class="toc-section-number">7.2.1</span>  Example</a></li>
  <li><a href="#example-15" id="toc-example-15" class="nav-link" data-scroll-target="#example-15"><span class="toc-section-number">7.2.2</span>  Example</a></li>
  <li><a href="#example-16" id="toc-example-16" class="nav-link" data-scroll-target="#example-16"><span class="toc-section-number">7.2.3</span>  Example</a></li>
  </ul></li>
  <li><a href="#other-comparison-operators" id="toc-other-comparison-operators" class="nav-link" data-scroll-target="#other-comparison-operators"><span class="toc-section-number">7.3</span>  Other Comparison Operators</a>
  <ul class="collapse">
  <li><a href="#example-17" id="toc-example-17" class="nav-link" data-scroll-target="#example-17"><span class="toc-section-number">7.3.1</span>  Example</a></li>
  <li><a href="#exercise-16" id="toc-exercise-16" class="nav-link" data-scroll-target="#exercise-16"><span class="toc-section-number">7.3.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#multiple-conditional-filtering" id="toc-multiple-conditional-filtering" class="nav-link" data-scroll-target="#multiple-conditional-filtering"><span class="toc-section-number">7.4</span>  Multiple Conditional Filtering</a>
  <ul class="collapse">
  <li><a href="#example-18" id="toc-example-18" class="nav-link" data-scroll-target="#example-18"><span class="toc-section-number">7.4.1</span>  Example</a></li>
  <li><a href="#exercise-18" id="toc-exercise-18" class="nav-link" data-scroll-target="#exercise-18"><span class="toc-section-number">7.4.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#some-filter-short-cuts." id="toc-some-filter-short-cuts." class="nav-link" data-scroll-target="#some-filter-short-cuts."><span class="toc-section-number">7.5</span>  Some Filter short cuts.</a>
  <ul class="collapse">
  <li><a href="#example-1-1" id="toc-example-1-1" class="nav-link" data-scroll-target="#example-1-1"><span class="toc-section-number">7.5.1</span>  Example 1</a></li>
  <li><a href="#example-2-1" id="toc-example-2-1" class="nav-link" data-scroll-target="#example-2-1"><span class="toc-section-number">7.5.2</span>  Example 2</a></li>
  <li><a href="#example-3-1" id="toc-example-3-1" class="nav-link" data-scroll-target="#example-3-1"><span class="toc-section-number">7.5.3</span>  Example 3</a></li>
  <li><a href="#filtering-text" id="toc-filtering-text" class="nav-link" data-scroll-target="#filtering-text"><span class="toc-section-number">7.5.4</span>  Filtering Text</a></li>
  <li><a href="#example-19" id="toc-example-19" class="nav-link" data-scroll-target="#example-19"><span class="toc-section-number">7.5.5</span>  Example</a></li>
  </ul></li>
  <li><a href="#aside---regular-expressions" id="toc-aside---regular-expressions" class="nav-link" data-scroll-target="#aside---regular-expressions"><span class="toc-section-number">7.6</span>  Aside - Regular Expressions</a></li>
  <li><a href="#more-filtering-methods" id="toc-more-filtering-methods" class="nav-link" data-scroll-target="#more-filtering-methods"><span class="toc-section-number">7.7</span>  More Filtering Methods</a>
  <ul class="collapse">
  <li><a href="#example-1-2" id="toc-example-1-2" class="nav-link" data-scroll-target="#example-1-2"><span class="toc-section-number">7.7.1</span>  Example 1</a></li>
  <li><a href="#example-2-2" id="toc-example-2-2" class="nav-link" data-scroll-target="#example-2-2"><span class="toc-section-number">7.7.2</span>  Example 2</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#deriving-new-columns" id="toc-deriving-new-columns" class="nav-link" data-scroll-target="#deriving-new-columns"><span class="toc-section-number">8</span>  Deriving New Columns</a>
  <ul class="collapse">
  <li><a href="#other-constant-values" id="toc-other-constant-values" class="nav-link" data-scroll-target="#other-constant-values"><span class="toc-section-number">8.1</span>  Other Constant Values</a>
  <ul class="collapse">
  <li><a href="#example-20" id="toc-example-20" class="nav-link" data-scroll-target="#example-20"><span class="toc-section-number">8.1.1</span>  Example</a></li>
  <li><a href="#exercise-20" id="toc-exercise-20" class="nav-link" data-scroll-target="#exercise-20"><span class="toc-section-number">8.1.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#numeric-values" id="toc-numeric-values" class="nav-link" data-scroll-target="#numeric-values"><span class="toc-section-number">8.2</span>  Numeric Values</a>
  <ul class="collapse">
  <li><a href="#example-21" id="toc-example-21" class="nav-link" data-scroll-target="#example-21"><span class="toc-section-number">8.2.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#boolean-and-binary-values" id="toc-boolean-and-binary-values" class="nav-link" data-scroll-target="#boolean-and-binary-values"><span class="toc-section-number">8.3</span>  Boolean and Binary Values</a>
  <ul class="collapse">
  <li><a href="#example-22" id="toc-example-22" class="nav-link" data-scroll-target="#example-22"><span class="toc-section-number">8.3.1</span>  Example</a></li>
  <li><a href="#example-23" id="toc-example-23" class="nav-link" data-scroll-target="#example-23"><span class="toc-section-number">8.3.2</span>  Example</a></li>
  <li><a href="#exercise-22" id="toc-exercise-22" class="nav-link" data-scroll-target="#exercise-22"><span class="toc-section-number">8.3.3</span>  Exercise</a></li>
  <li><a href="#more-on-the-issue-of-booleans-and-missing-values" id="toc-more-on-the-issue-of-booleans-and-missing-values" class="nav-link" data-scroll-target="#more-on-the-issue-of-booleans-and-missing-values"><span class="toc-section-number">8.3.4</span>  More on the issue of Booleans and Missing Values</a></li>
  <li><a href="#example-24" id="toc-example-24" class="nav-link" data-scroll-target="#example-24"><span class="toc-section-number">8.3.5</span>  Example</a></li>
  </ul></li>
  <li><a href="#example---filling-in-missing-values-with-a-constant" id="toc-example---filling-in-missing-values-with-a-constant" class="nav-link" data-scroll-target="#example---filling-in-missing-values-with-a-constant"><span class="toc-section-number">8.4</span>  Example - Filling in missing values with a constant</a></li>
  <li><a href="#mapping-new-values" id="toc-mapping-new-values" class="nav-link" data-scroll-target="#mapping-new-values"><span class="toc-section-number">8.5</span>  Mapping New Values</a></li>
  <li><a href="#deleting-columns" id="toc-deleting-columns" class="nav-link" data-scroll-target="#deleting-columns"><span class="toc-section-number">8.6</span>  Deleting columns</a>
  <ul class="collapse">
  <li><a href="#example-1-3" id="toc-example-1-3" class="nav-link" data-scroll-target="#example-1-3"><span class="toc-section-number">8.6.1</span>  Example 1</a></li>
  <li><a href="#example-2-3" id="toc-example-2-3" class="nav-link" data-scroll-target="#example-2-3"><span class="toc-section-number">8.6.2</span>  Example 2</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#merging-data" id="toc-merging-data" class="nav-link" data-scroll-target="#merging-data"><span class="toc-section-number">9</span>  Merging Data</a>
  <ul class="collapse">
  <li><a href="#types-of-join" id="toc-types-of-join" class="nav-link" data-scroll-target="#types-of-join"><span class="toc-section-number">9.1</span>  Types of Join</a>
  <ul class="collapse">
  <li><a href="#example-25" id="toc-example-25" class="nav-link" data-scroll-target="#example-25"><span class="toc-section-number">9.1.1</span>  Example</a></li>
  <li><a href="#exercise-24" id="toc-exercise-24" class="nav-link" data-scroll-target="#exercise-24"><span class="toc-section-number">9.1.2</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#extension-exercise" id="toc-extension-exercise" class="nav-link" data-scroll-target="#extension-exercise"><span class="toc-section-number">9.2</span>  Extension Exercise</a></li>
  <li><a href="#union-merge" id="toc-union-merge" class="nav-link" data-scroll-target="#union-merge"><span class="toc-section-number">9.3</span>  Union Merge</a>
  <ul class="collapse">
  <li><a href="#example-26" id="toc-example-26" class="nav-link" data-scroll-target="#example-26"><span class="toc-section-number">9.3.1</span>  Example</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="toc-section-number">10</span>  Chapter Summary</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 4 - Working with DataFrames</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><img src="../images/AF_DSC_banner.png" class="img-fluid" alt="Government Analysis Function and Data Science Campus Logos."></p>
<div class="cell">

</div>
<p>This is a HTML document. The Introduction to Python course is written and intended to be used in a Jupyter Notebook file. These HTML documents have been made available for users who require screen readers or other accessibility needs. These HTML documents have been tested, but if you notice any errors or any compatibility issues please contact us on the GSS Capability email inbox.</p>
<p>If you are using a screen reader you will need to set your punctuation level (sometimes called verbosity) to full, especially for the code sections.</p>
<p><em>Chapter Overview and Learning Objectives</em>:</p>
<ul>
<li><p><a href="#packages">Packages and Datasets</a></p></li>
<li><p><a href="#exploring">Exploring Datasets</a></p>
<ul>
<li>Quick Previews</li>
<li>Size</li>
<li>Data Types</li>
<li>Column Names</li>
</ul></li>
<li><p><a href="#sorting">Sorting Data</a></p></li>
<li><p><a href="#subsetting">Subsetting Data</a></p>
<ul>
<li>Selecting Single Columns</li>
<li>Selecting Multiple Columns</li>
</ul></li>
<li><p><a href="#filter">Filtering</a></p>
<ul>
<li>Single Conditional Filtering</li>
<li>Multiple Conditional Filtering</li>
</ul></li>
<li><p><a href="#new_columns">Deriving New Columns</a></p>
<ul>
<li>Constant Values</li>
<li>Numeric Values</li>
<li>Boolean and Binary Values</li>
<li>Mapping new values</li>
<li>Deleting columns</li>
</ul></li>
<li><p><a href="#merge">Merging Data</a></p>
<ul>
<li>About Merging</li>
<li>Merging using Pandas</li>
<li>Union joins</li>
</ul></li>
</ul>
<p><a id="packages" href=""></a></p>
<section id="packages-and-datasets" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Packages and Datasets</h1>
<section id="packages" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="packages"><span class="header-section-number">1.1</span> Packages</h2>
<p>As a reminder, we should always import our packages at the top of our script. In this chapter (and for the rest of the course) we will use pandas, and give it the alias pd.</p>
<section id="exercise" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="exercise"><span class="header-section-number">1.1.1</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href=""><strong>Packages</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Import Pandas and give it the alias pd</p>
</div>
<div id="tabset-1-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="datasets" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="datasets"><span class="header-section-number">1.2</span> Datasets</h2>
<p>Good practice also dictates that we import our datasets at the top of our script too, following the import of packages.</p>
<p>In this session we’ll be using the following datasets.</p>
<table class="table">
<thead>
<tr class="header">
<th>variable name</th>
<th>file name</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>animals</td>
<td>animals.csv</td>
<td></td>
</tr>
<tr class="even">
<td>titanic</td>
<td>titanic.xlsx</td>
<td></td>
</tr>
<tr class="odd">
<td>joining_data1</td>
<td>joining_data1.csv</td>
<td></td>
</tr>
<tr class="even">
<td>joining_data2</td>
<td>joining_data2.csv</td>
<td></td>
</tr>
<tr class="odd">
<td>union_join_data</td>
<td>union_data.csv</td>
<td></td>
</tr>
<tr class="even">
<td>marvel_left</td>
<td>joining_exercise1.csv</td>
<td></td>
</tr>
<tr class="odd">
<td>marvel_right</td>
<td>joining_exercise2.csv</td>
<td></td>
</tr>
</tbody>
</table>
<p>These are all straight forward data imports with no additional parameters required. This is a good test of the techniques covered in Chapter 3.</p>
<section id="exercise-1" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">1.2.1</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href=""><strong>Load in the Data</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Load in these datasets listed above</p>
<p>You can check your variables are loaded by using %whos in Jupyter. In Spyder or other IDE’s they should appear in your variable explorer.</p>
</div>
<div id="tabset-2-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a>animals <span class="op">=</span> pd.read_csv(<span class="st">"../data/animals.csv"</span>)</span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> pd.read_excel(<span class="st">"../data/titanic.xlsx"</span>)</span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a>joining_data1 <span class="op">=</span> pd.read_csv(<span class="st">"../data/joining_data1.csv"</span>)</span>
<span id="cb2-4"><a aria-hidden="true" tabindex="-1"></a>joining_data2 <span class="op">=</span> pd.read_csv(<span class="st">"../data/joining_data2.csv"</span>)</span>
<span id="cb2-5"><a aria-hidden="true" tabindex="-1"></a>union_join_data <span class="op">=</span> pd.read_csv(<span class="st">"../data/union_data.csv"</span>)</span>
<span id="cb2-6"><a aria-hidden="true" tabindex="-1"></a>marvel_left <span class="op">=</span> pd.read_csv(<span class="st">"../data/joining_exercise1.csv"</span>)</span>
<span id="cb2-7"><a aria-hidden="true" tabindex="-1"></a>marvel_right <span class="op">=</span> pd.read_csv(<span class="st">"../data/joining_exercise2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><a id="exploring" href=""></a></p>
</section>
</section>
</section>
<section id="exploring-datasets" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Exploring Datasets</h1>
<p>Before you start working with a dataset it is important to examine it. For example:</p>
<ul>
<li>Do the values look how you would expect?</li>
<li>Does the data have the right number of rows and columns?</li>
<li>Do the columns have your expected data types?</li>
<li>Is your data <a href="https://en.wikipedia.org/wiki/Data_cleansing">clean?</a></li>
</ul>
<p>In this section we’ll look at various ways of exploring our data, with the aim of answering the above questions.</p>
<p>In chapter 5 we will look at how we can clean our data. When working with data, cleaning is normally a step we’d do first. Those concepts are a little more complicated; and we like to establish a good base knowledge of how Python works first. For these sessions we’ll be using data that has already been cleaned to make it easy to handle.</p>
<section id="quick-previews" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="quick-previews"><span class="header-section-number">2.1</span> Quick Previews</h2>
<p>In the last section we looked at three methods of quickly inspecting our dataframes.</p>
<ul>
<li>.head() - Top 5 rows (can be altered with parameter n =)</li>
<li>.tail() - Bottom 5 Rows (can be altered with paramter n =)</li>
<li>.sample() - 1 Randomly sampled row.</li>
</ul>
<p>We use these because we do not always want Jupyter Notebooks to print out large datasets; we just want to check that certain operations have worked on a smaller amount of data.</p>
<p>To review, we can modify how many rows are returned by putting a number within the round brackets. The number in the round brackets is known as an argument. .head() and .tail() have a default argument of 5; if we don’t pass an argument that default behaviour is used.</p>
<p>You may recall that we mentioned this parameter is ‘n =’, but we need not specify the name, just the argument. Why is this? This is because Python knows what parameter we are giving an argument for when specifying the integer to .head() or .tail().</p>
<p>However, don’t always rely on this, as order comes into play when functions/methods have a large number of parameters (and particularly multiple ones of the same type, integers etc). As such, it is good practice to use the name of the parameter in most cases.</p>
<section id="example" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="example"><span class="header-section-number">2.1.1</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a>animals.head(<span class="dv">3</span>)</span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Best Practice</span></span>
<span id="cb3-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># animals.head(n = 3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 139091 </td>
   <td style="text-align:left;"> 01/01/2009 03:01 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 510 </td>
   <td style="text-align:left;"> DOG WITH JAW TRAPPED IN MAGAZINE RACK,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Norbury </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 275091 </td>
   <td style="text-align:left;"> 01/01/2009 08:51 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH FOX TRAPPED,B15 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:left;"> Railings </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2075091 </td>
   <td style="text-align:left;"> 04/01/2009 10:07 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> DOG CAUGHT IN DRAIN,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Pipe or drain </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Wallington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>If you run just animals, you may notice that Jupyter does not display all of the rows in our DataFrame.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/sort_missing_rows.PNG" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image showing rows of a DataFrame, it displays the first 30 rows then some elipsis and the last 30 rows.</figcaption><p></p>
</figure>
</div>
<p>Instead it represents these rows using three dots, … (ellipsis) symbol. You may also see this with columns. This often happens in large datasets; and helps to save computational power. This is similar to the max print option in Spyder and other IDEs.</p>
<p>While there are various ways of changing this setting with Jupyter (Stack Overflow has several answers), if you are regularly using large DataFrames, and wish to inspect all rows you may wish to use VSCode or another IDE, since many of these have in built data viewers (which allow us to view the whole dataset).</p>
<p>We can also use .info() this gives us information about:</p>
<ul>
<li>The class of the object – a pandas DataFrame</li>
<li>The range (or length of our index), a.k.a the number of rows</li>
<li>How many columns we have</li>
<li>The column names</li>
<li>The number of non-null entries (a.k.a without missing values)</li>
<li>The data type of the column</li>
<li>The number of columns of each data type.</li>
</ul>
</section>
<section id="example-1" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="example-1"><span class="header-section-number">2.1.2</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a>animals.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 5752 entries, 0 to 5751
Data columns (total 19 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   IncidentNumber              5752 non-null   object 
 1   DateTimeOfCall              5752 non-null   object 
 2   CalYear                     5752 non-null   int64  
 3   FinYear                     5752 non-null   object 
 4   TypeOfIncident              5752 non-null   object 
 5   PumpCount                   5716 non-null   float64
 6   PumpHoursTotal              5716 non-null   float64
 7   HourlyNominalCost(£)        5752 non-null   int64  
 8   IncidentNominalCost(£)      5716 non-null   float64
 9   FinalDescription            5749 non-null   object 
 10  AnimalGroupParent           5752 non-null   object 
 11  PropertyType                5752 non-null   object 
 12  SpecialServiceTypeCategory  5752 non-null   object 
 13  SpecialServiceType          5752 non-null   object 
 14  Borough                     5748 non-null   object 
 15  StnGroundName               5752 non-null   object 
 16  AnimalClass                 5752 non-null   object 
 17  Code                        5742 non-null   object 
 18  London                      5742 non-null   object 
dtypes: float64(3), int64(2), object(14)
memory usage: 853.9+ KB</code></pre>
</div>
</div>
</section>
</section>
<section id="size" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="size"><span class="header-section-number">2.2</span> Size</h2>
<p>Knowing the size of our DataFrame is also useful (a.k.a the number of rows and columns), separately to what .info() gives us. Often we want to save these elements to variables and this is difficult with that method and as such, we use other methods to draw out this information for further analysis.</p>
<section id="example-2" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="example-2"><span class="header-section-number">2.2.1</span> Example</h3>
<p>.shape provides us a tuple with the dimensions of the object, in the form (number of rows, number of columns).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>animals.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5752, 19)</code></pre>
</div>
</div>
<p>Notice this is the first example of an attribute of the DataFrame rather than a method, so doesn’t require the round brackets at the end of its call. We talk a bit more about the similarities and differences between functions, methods and attributes in chapter 2. Feel free to review that section if you are stuck.</p>
<p>We can use our indexing brackets (also discussed at length in chapter 2) to return an item in this tuple, for example the number rows at index 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>animals.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5752</code></pre>
</div>
</div>
<p>And the number of columns at index 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a>animals.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
</div>
<p>As an aside:</p>
<p>Because .shape returns us a tuple we can assign each of these to it’s own variable. To do this we give our variable names in the order of the tuple output, separated by a comma before our assignment operator (=).</p>
</section>
<section id="example-3" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="example-3"><span class="header-section-number">2.2.2</span> Example</h3>
<p>Our tuple outputs rows first then columns, so we give our variables as nrow and ncol. This is also a great chance to show off multi-variable assignment introduced in chapter 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>nrow, ncol <span class="op">=</span> animals.shape</span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are"</span>, nrow, <span class="st">"rows, and"</span>, ncol, <span class="st">"columns in the animals DataFrame."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 5752 rows, and 19 columns in the animals DataFrame.</code></pre>
</div>
</div>
<p>Of course, you can always do this separately without multi-variable assignment as below, but that way is certainly the most efficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>nrow <span class="op">=</span> animals.shape[<span class="dv">0</span>]</span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a>ncol <span class="op">=</span> animals.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also use the inbuilt len() function to find the <strong>len</strong>gth. This will return us the number of rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(animals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5752</code></pre>
</div>
</div>
<p>We can also modify this to return us the number of columns as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(animals.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
</div>
<p>Note that the .columns <strong>attribute</strong> is also very useful, returning something called an Index object containing the ordered column names of the pandas object. Returning the length of such an object gives us the number of values (a.k.a the number of columns).</p>
<p>More info on this datatype is available <a href="https://pandas.pydata.org/docs/reference/indexing.html">here</a>, but I would suggest returning to this later as <strong>reference</strong> material.</p>
</section>
<section id="exercise-2" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">2.2.3</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Look at the dimensions of the titanic DataFrame.</p>
<ol type="a">
<li>Use shape to return the tuple of rows and columns.</li>
<li>Use multi-variable assignment to obtain the rows and columns as variables.</li>
<li>Print the results from (b) in a suitable sentence.</li>
</ol>
</div>
<div id="tabset-3-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a) </span></span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a>titanic.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1309, 14)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a>nrow, ncol <span class="op">=</span> titanic.shape</span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nrow, ncol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1309 14</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (c)</span></span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are"</span>, nrow, <span class="st">"rows and"</span>, ncol, <span class="st">"columns in the titanic DataFrame."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 1309 rows and 14 columns in the titanic DataFrame.</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-types" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Types</h1>
<p>It is also important to check the data types when we bring in data. If you’ve worked with other analytical software before you’ll know that sometimes data doesn’t come in as we would expect.</p>
<section id="observing-the-datatypes-in-our-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="observing-the-datatypes-in-our-data"><span class="header-section-number">3.1</span> Observing the datatypes in our data</h2>
<p>We do this using .dtypes, another very useful attribute (delivering on that promise that we will use attributes as well as methods!).</p>
<section id="example-4" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="example-4"><span class="header-section-number">3.1.1</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a>animals.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IncidentNumber                 object
DateTimeOfCall                 object
CalYear                         int64
FinYear                        object
TypeOfIncident                 object
PumpCount                     float64
PumpHoursTotal                float64
HourlyNominalCost(£)            int64
IncidentNominalCost(£)        float64
FinalDescription               object
AnimalGroupParent              object
PropertyType                   object
SpecialServiceTypeCategory     object
SpecialServiceType             object
Borough                        object
StnGroundName                  object
AnimalClass                    object
Code                           object
London                         object
dtype: object</code></pre>
</div>
</div>
<p>We have some of the data types we’re seen before</p>
<ul>
<li><strong>int</strong> represents integers; our whole numbers
<ul>
<li>CalYear (Calendar Year) is column of whole numbers</li>
</ul></li>
<li><strong>float</strong> represents ‘floating point’ numbers or decimals
<ul>
<li>IncidentNominalCost(£) (The financial cost of each incident) is a decimal number.</li>
</ul></li>
<li><strong>object</strong> or <strong>O</strong> here represents what we’ve been calling <em>string</em> data so far, in that they are text values
<ul>
<li>AnimalClass (The kind of animal) is a text based value.</li>
</ul></li>
</ul>
<p>We may also see</p>
<ul>
<li><strong>bool</strong> - representing Boolean values; our True and False</li>
<li><strong>datetime</strong> - date and time values</li>
<li><strong>category</strong> - a special pandas datatype for categorical or factor variables (see Chapter 7 for more info, this is <strong>reference</strong> material)</li>
</ul>
<p>You may notice that some categories have not come in quite how we would expect.</p>
</section>
<section id="example-5" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="example-5"><span class="header-section-number">3.1.2</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">'DateTimeOfCall'</span>].dtypes</span>
<span id="cb27-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This is how we select a single column; we'll cover this later</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dtype('O')</code></pre>
</div>
</div>
<p>DateTimeOfCall has come in as an object or text value; when it should be datetime. This is extremely common with dates and times in a variety of software; not just Python!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/iso_8601.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">An XKCD comic showing a variety of date formats, ranging from standardised to ridiculous. The comic states that the correct way to write numeric dates is following ISO standards with a 4 number year, two digit month and two digit date, seperated by hypens.</figcaption><p></p>
</figure>
</div>
<center>
<a href="https://xkcd.com/1179/"> Source: xkcd ISO 8601</a>
</center>
<p>Python will often choose an object data type for columns: if there’s any ambiguity over the data type. This is because this data type retains all the characteristics of the data and allows us to make the choice about how to process it.</p>
<p>For example, the date 01/11/19 could be interpreted as either:</p>
<ul>
<li>1st November 2019</li>
<li>11th January 2019</li>
<li>19th November 2001</li>
</ul>
<p>depending on region (which makes the most sense to you?).</p>
<p>Since we don’t look at handling date and time data in this course; we’ll leave these columns alone for now. This is a perfect time to reference the <strong>Dates and Times in Python</strong> course on the Learning Hub! This is a recommended follow up to the Introduction to Python course.</p>
<p>For an overview that is much less in-depth than that course, the following resource is available:</p>
<p><a href="https://www.geeksforgeeks.org/python-working-with-date-and-time-using-pandas/">This Geeks for Geeks tutorial link</a> is a tutorial for handling dates and times using pandas.</p>
</section>
<section id="exercise-4" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="exercise-4"><span class="header-section-number">3.1.3</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Look at the data types of the titanic DataFrame.</p>
<p>Are there any values you didn’t expect to see?</p>
<p>You can check the Data Dictionary (an explanation of each column) <a href="https://www.kaggle.com/c/titanic/data">here</a></p>
</div>
<div id="tabset-4-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the data types of the titanic DataFrame.</span></span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a>titanic.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pclass         int64
survived       int64
name          object
sex           object
age          float64
sibsp          int64
parch          int64
ticket        object
fare         float64
cabin         object
embarked      object
home.dest     object
body         float64
boat          object
dtype: object</code></pre>
</div>
</div>
<ul>
<li><p>We may expect “survived” to be a boolean (since it is a binary choice, yes or no) but it’s a numeric. To come over as boolean it would’ve needed to be ‘TRUE’, ‘FALSE’ or ‘True’, ‘False’.</p></li>
<li><p>We may expect “boat” to be a number, but some boats are referred to by letters.</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="column-names" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="column-names"><span class="header-section-number">3.2</span> Column Names</h2>
<p>It is important to know what your columns are called because in Python we commonly select our columns by name. It is also key to know how they are constructed (lower case, snake case etc) as Python is case sensitive.</p>
<section id="example-6" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="example-6"><span class="header-section-number">3.2.1</span> Example</h3>
<p>First we give the DataFrame name then the name of our column, in quotes, inside square brackets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">'AnimalClass'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0       Mammal
1       Mammal
2       Mammal
3       Mammal
4       Mammal
         ...  
5747    Mammal
5748    Mammal
5749    Mammal
5750    Mammal
5751    Mammal
Name: AnimalClass, Length: 5752, dtype: object</code></pre>
</div>
</div>
<p>We can then add a method to the end, for example .head().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">'AnimalClass'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    Mammal
1    Mammal
2    Mammal
3    Mammal
4    Mammal
Name: AnimalClass, dtype: object</code></pre>
</div>
</div>
<p>While Python can handle column names with spaces, symbols and irregular capitalization; it is often easier to clean them. We’ll have a look at how to do this in Chapter 5.</p>
</section>
<section id="example-7" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="example-7"><span class="header-section-number">3.2.2</span> Example</h3>
<p>As a reminder, We can access our columns by using the .columns attribute to return an Index datatype filled with the column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a aria-hidden="true" tabindex="-1"></a>animals.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['IncidentNumber', 'DateTimeOfCall', 'CalYear', 'FinYear',
       'TypeOfIncident', 'PumpCount', 'PumpHoursTotal', 'HourlyNominalCost(£)',
       'IncidentNominalCost(£)', 'FinalDescription', 'AnimalGroupParent',
       'PropertyType', 'SpecialServiceTypeCategory', 'SpecialServiceType',
       'Borough', 'StnGroundName', 'AnimalClass', 'Code', 'London'],
      dtype='object')</code></pre>
</div>
</div>
<p>It would be nice to display them as a list to make the object easier to work with, so we can add (or <strong>chain</strong>) the method .tolist() on the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a aria-hidden="true" tabindex="-1"></a>animals.columns.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['IncidentNumber', 'DateTimeOfCall', 'CalYear', 'FinYear', 'TypeOfIncident', 'PumpCount', 'PumpHoursTotal', 'HourlyNominalCost(£)', 'IncidentNominalCost(£)', 'FinalDescription', 'AnimalGroupParent', 'PropertyType', 'SpecialServiceTypeCategory', 'SpecialServiceType', 'Borough', 'StnGroundName', 'AnimalClass', 'Code', 'London']</code></pre>
</div>
</div>
</section>
<section id="exercise-6" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="exercise-6"><span class="header-section-number">3.2.3</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<ol type="a">
<li><p>Look at the column names of the titanic DataFrame and convert them to a list, giving it an appropriate variable name.</p></li>
<li><p>Use indexing to return the column name ‘embarked’.</p></li>
<li><p>Use negative indexing to return the list without ‘boat’.</p></li>
</ol>
</div>
<div id="tabset-5-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb39-2"><a aria-hidden="true" tabindex="-1"></a>titanic_cols <span class="op">=</span> titanic.columns.tolist()</span>
<span id="cb39-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a aria-hidden="true" tabindex="-1"></a>titanic_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['pclass', 'survived', 'name', 'sex', 'age', 'sibsp', 'parch', 'ticket', 'fare', 'cabin', 'embarked', 'home.dest', 'body', 'boat']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb41-2"><a aria-hidden="true" tabindex="-1"></a>titanic_cols[<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'embarked'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (c)</span></span>
<span id="cb43-2"><a aria-hidden="true" tabindex="-1"></a>titanic_cols[:<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['pclass', 'survived', 'name', 'sex', 'age', 'sibsp', 'parch', 'ticket', 'fare', 'cabin', 'embarked', 'home.dest', 'body']</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can also use Jupyter’s auto complete feature to help us when accessing the names of our columns. Copy the cell below place your cursor after the H and hit tab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">'H'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You’ll see that the auto complete option gives us the name of our HourlyNominalCost(£) column. This can be a really useful shortcut when we’re writing our code, circumventing the need to type out full column names.</p>
<p><a id="sorting" href=""></a></p>
</section>
</section>
</section>
<section id="sorting-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Sorting Data</h1>
<p>Our data is displayed in the same order as the source data, which means that we may want to sort our data, based on specific columns.</p>
<section id="the-method-of-sorting-in-pandas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-method-of-sorting-in-pandas"><span class="header-section-number">4.1</span> The method of sorting in Pandas</h2>
<section id="example-8" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="example-8"><span class="header-section-number">4.1.1</span> Example</h3>
<p>To do this we use the method .sort_values(by=“column name”). When transforming data like this, we want to assign the new object as we don’t want to re-type this process each time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a>animals_sorted <span class="op">=</span> animals.sort_values(by<span class="op">=</span><span class="st">"IncidentNominalCost(£)"</span>)</span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a>animals_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 122 </td>
   <td style="text-align:left;"> 52735091 </td>
   <td style="text-align:left;"> 31/03/2009 07:40 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> CAT TRAPPED BETWEEN WALLS,B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Takeaway, fast food </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Biggin Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 88 </td>
   <td style="text-align:left;"> 36729091 </td>
   <td style="text-align:left;"> 04/03/2009 23:35 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> DOG TRAPPED IN STREAM, B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Canal/riverbank vegetation </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Domestic pet </td>
   <td style="text-align:left;"> Lewisham </td>
   <td style="text-align:left;"> Lee Green </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AZ </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 86 </td>
   <td style="text-align:left;"> 36590091 </td>
   <td style="text-align:left;"> 04/03/2009 18:36 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> DOG TRAPPED IN WATER,J15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Wild animal rescue from water or mud </td>
   <td style="text-align:left;"> Merton </td>
   <td style="text-align:left;"> Wimbledon </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BA </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 85 </td>
   <td style="text-align:left;"> 35781091 </td>
   <td style="text-align:left;"> 03/03/2009 12:54 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> PIGEON TRAPPED IN SHELTER, B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Railway building - other </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Newham </td>
   <td style="text-align:left;"> Plaistow </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00BB </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 84 </td>
   <td style="text-align:left;"> 35738091 </td>
   <td style="text-align:left;"> 03/03/2009 11:05 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> CAT TRAPPED BETWEEN CHIMNEY POTS, B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Newham </td>
   <td style="text-align:left;"> East Ham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BB </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>There are additional arguments we can set, for example, by default the values are sorted in ascending order, by changing ascending= to ascending=False we can sort in descending order instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a aria-hidden="true" tabindex="-1"></a>animals_sorted <span class="op">=</span> animals.sort_values(by<span class="op">=</span><span class="st">"IncidentNominalCost(£)"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-2"><a aria-hidden="true" tabindex="-1"></a>animals_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 4450 </td>
   <td style="text-align:left;"> 098141-28072016 </td>
   <td style="text-align:left;"> 28/07/2016 13:49 </td>
   <td style="text-align:right;"> 2016 </td>
   <td style="text-align:left;"> 2016/17 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 326 </td>
   <td style="text-align:right;"> 3912 </td>
   <td style="text-align:left;"> CAT STUCK WITHIN WALL SPACE  RSPCA IN ATTENDANCE </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - 4 to 9 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving domestic animal - Other action </td>
   <td style="text-align:left;"> Camden </td>
   <td style="text-align:left;"> Kentish Town </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2542 </td>
   <td style="text-align:left;"> 48360131 </td>
   <td style="text-align:left;"> 19/04/2013 07:01 </td>
   <td style="text-align:right;"> 2013 </td>
   <td style="text-align:left;"> 2013/14 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 290 </td>
   <td style="text-align:right;"> 3480 </td>
   <td style="text-align:left;"> FOAL IN RIVER WATER LEVEL ONE IMPLEMENTED </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3757 </td>
   <td style="text-align:left;"> 62700151 </td>
   <td style="text-align:left;"> 22/05/2015 11:34 </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:left;"> 2015/16 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 2980 </td>
   <td style="text-align:left;"> HORSE FALLEN INTO SWIMMING  POOL </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Other outdoor structures </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Biggin Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5568 </td>
   <td style="text-align:left;"> 092389-09072018 </td>
   <td style="text-align:left;"> 09/07/2018 08:35 </td>
   <td style="text-align:right;"> 2018 </td>
   <td style="text-align:left;"> 2018/19 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 333 </td>
   <td style="text-align:right;"> 2664 </td>
   <td style="text-align:left;"> HORSE TRAPPED IN DOORWAY ADDITIONAL FRU REQUESTED FROM SCENE - SILENT APPROACH </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy domestic animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3143 </td>
   <td style="text-align:left;"> 49076141 </td>
   <td style="text-align:left;"> 22/04/2014 09:54 </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:left;"> 2014/15 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 295 </td>
   <td style="text-align:right;"> 2655 </td>
   <td style="text-align:left;"> KITTEN TRAPPED IN CHIMNEY </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - Up to 3 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist trapped domestic animal </td>
   <td style="text-align:left;"> Hounslow </td>
   <td style="text-align:left;"> Feltham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AT </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We can also sort by more than one column, but we can’t just type out the column names in succession to the .sort_values() method. We must include them in a list instead, where order is important.</p>
</section>
<section id="example-9" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="example-9"><span class="header-section-number">4.1.2</span> Example</h3>
<p>Here we are sorting by “IncidentNominalCost(£)”; and then by “AnimalClass”. Notice object (text/string) columns are sorted by <em>alphabetical</em> order. The reason order is important is because it creates a dependence, namely that sorting by the second column is entirely dependent on the sorting of the first column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a>animals_sorted <span class="op">=</span> animals.sort_values(by<span class="op">=</span>[<span class="st">"IncidentNominalCost(£)"</span>, <span class="st">"AnimalClass"</span>])</span>
<span id="cb48-2"><a aria-hidden="true" tabindex="-1"></a>animals_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 27 </td>
   <td style="text-align:left;"> 7051091 </td>
   <td style="text-align:left;"> 11/01/2009 12:32 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> SWAN STUCK ON ROOF,B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Domestic garden (vegetation not equipment) </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Hornchurch </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 31 </td>
   <td style="text-align:left;"> 9252091 </td>
   <td style="text-align:left;"> 15/01/2009 12:38 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH BIRD TRAPPED IN TREE BY FOOT,B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Wasteland </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Lambeth </td>
   <td style="text-align:left;"> Clapham </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AY </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> 13245091 </td>
   <td style="text-align:left;"> 22/01/2009 21:35 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> BIRD IN CHIMNEY,B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Harrow </td>
   <td style="text-align:left;"> Stanmore </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AQ </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 63 </td>
   <td style="text-align:left;"> 21760091 </td>
   <td style="text-align:left;"> 07/02/2009 11:12 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> PIGEON IN PRECARIOUS POSITION, B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Tree scrub </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Bird </td>
   <td style="text-align:left;"> Westminster </td>
   <td style="text-align:left;"> Soho </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00BK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 68 </td>
   <td style="text-align:left;"> 26715091 </td>
   <td style="text-align:left;"> 15/02/2009 15:53 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> SWAN IN DISTRESS, J15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Bird </td>
   <td style="text-align:left;"> Tower Hamlets </td>
   <td style="text-align:left;"> Shadwell </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00BG </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>When sorting more than one column, it’s best to specify ascending= as a list as well, to improve the readability and accessibility of our code. This list is in the same order as our columns and as such .sort_values() will apply column wise (first column, ascending, second column, descending etc).</p>
<p>Some versions of Pandas will sort both columns as descending if we just supply ascending = False ; however some won’t, so it’s better to be clear about what we want to do. By using a list I also have finer control in that I could have one in ascending order, and one in descending order if I wished.</p>
</section>
<section id="example-10" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="example-10"><span class="header-section-number">4.1.3</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a aria-hidden="true" tabindex="-1"></a>animals_sorted_desc <span class="op">=</span> animals.sort_values(by<span class="op">=</span>[<span class="st">"IncidentNominalCost(£)"</span>, <span class="st">"AnimalClass"</span>], </span>
<span id="cb49-2"><a aria-hidden="true" tabindex="-1"></a>                                          ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>])</span>
<span id="cb49-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a aria-hidden="true" tabindex="-1"></a>animals_sorted_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 4450 </td>
   <td style="text-align:left;"> 098141-28072016 </td>
   <td style="text-align:left;"> 28/07/2016 13:49 </td>
   <td style="text-align:right;"> 2016 </td>
   <td style="text-align:left;"> 2016/17 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 326 </td>
   <td style="text-align:right;"> 3912 </td>
   <td style="text-align:left;"> CAT STUCK WITHIN WALL SPACE  RSPCA IN ATTENDANCE </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - 4 to 9 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving domestic animal - Other action </td>
   <td style="text-align:left;"> Camden </td>
   <td style="text-align:left;"> Kentish Town </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2542 </td>
   <td style="text-align:left;"> 48360131 </td>
   <td style="text-align:left;"> 19/04/2013 07:01 </td>
   <td style="text-align:right;"> 2013 </td>
   <td style="text-align:left;"> 2013/14 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 290 </td>
   <td style="text-align:right;"> 3480 </td>
   <td style="text-align:left;"> FOAL IN RIVER WATER LEVEL ONE IMPLEMENTED </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3757 </td>
   <td style="text-align:left;"> 62700151 </td>
   <td style="text-align:left;"> 22/05/2015 11:34 </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:left;"> 2015/16 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 2980 </td>
   <td style="text-align:left;"> HORSE FALLEN INTO SWIMMING  POOL </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Other outdoor structures </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Biggin Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5568 </td>
   <td style="text-align:left;"> 092389-09072018 </td>
   <td style="text-align:left;"> 09/07/2018 08:35 </td>
   <td style="text-align:right;"> 2018 </td>
   <td style="text-align:left;"> 2018/19 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 333 </td>
   <td style="text-align:right;"> 2664 </td>
   <td style="text-align:left;"> HORSE TRAPPED IN DOORWAY ADDITIONAL FRU REQUESTED FROM SCENE - SILENT APPROACH </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy domestic animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3143 </td>
   <td style="text-align:left;"> 49076141 </td>
   <td style="text-align:left;"> 22/04/2014 09:54 </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:left;"> 2014/15 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 295 </td>
   <td style="text-align:right;"> 2655 </td>
   <td style="text-align:left;"> KITTEN TRAPPED IN CHIMNEY </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - Up to 3 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist trapped domestic animal </td>
   <td style="text-align:left;"> Hounslow </td>
   <td style="text-align:left;"> Feltham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AT </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="exercise-8" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="exercise-8"><span class="header-section-number">4.1.4</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<ol type="a">
<li><p>Sort the titanic DataFrame by the age column in descending order, name it titanic_sorted.</p></li>
<li><p>Sort the titanic DataFrame by the age <strong>then</strong> sex columns, both in ascending order.</p></li>
<li><p>Using (b), pick out the sex and of the youngest person on board the titanic.</p></li>
<li><p>Sort the titanic DataFrame by ascending fare <strong>then</strong> descending age, naming it appropriately.</p></li>
<li><p>Use your answer to part (d) to identify the oldest person who paid the least fare.</p></li>
</ol>
</div>
<div id="tabset-6-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb50-2"><a aria-hidden="true" tabindex="-1"></a>titanic_sorted <span class="op">=</span> titanic.sort_values(by<span class="op">=</span><span class="st">"age"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-3"><a aria-hidden="true" tabindex="-1"></a>titanic_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ticket </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> fare </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> cabin </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> embarked </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> home.dest </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Barkworth, Mr. Algernon Henry Wilson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 27042 </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:left;"> A23 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Hessle, Yorks </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> B </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 61 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cavendish, Mrs. Tyrell William (Julia Florence Siegel) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 76 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 19877 </td>
   <td style="text-align:right;"> 78.8500 </td>
   <td style="text-align:left;"> C46 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Little Onn Hall, Staffs </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1235 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Svensson, Mr. Johan </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 74 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 347060 </td>
   <td style="text-align:right;"> 7.7750 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 135 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Goldschmidt, Mr. George B </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17754 </td>
   <td style="text-align:right;"> 34.6542 </td>
   <td style="text-align:left;"> A5 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Artagaveytia, Mr. Ramon </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17609 </td>
   <td style="text-align:right;"> 49.5042 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Montevideo, Uruguay </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb51-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a aria-hidden="true" tabindex="-1"></a>titanic_age_sex <span class="op">=</span> titanic.sort_values(by <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'sex'</span>], ascending <span class="op">=</span> [<span class="va">True</span>, <span class="va">True</span>])</span>
<span id="cb51-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This also works but is not good practice</span></span>
<span id="cb51-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># titanic_age_sex = titanic.sort_values(by = ['age', 'sex'])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ticket </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> fare </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> cabin </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> embarked </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> home.dest </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Barkworth, Mr. Algernon Henry Wilson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 27042 </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:left;"> A23 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Hessle, Yorks </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> B </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 61 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cavendish, Mrs. Tyrell William (Julia Florence Siegel) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 76 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 19877 </td>
   <td style="text-align:right;"> 78.8500 </td>
   <td style="text-align:left;"> C46 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Little Onn Hall, Staffs </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1235 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Svensson, Mr. Johan </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 74 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 347060 </td>
   <td style="text-align:right;"> 7.7750 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 135 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Goldschmidt, Mr. George B </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17754 </td>
   <td style="text-align:right;"> 34.6542 </td>
   <td style="text-align:left;"> A5 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Artagaveytia, Mr. Ramon </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17609 </td>
   <td style="text-align:right;"> 49.5042 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Montevideo, Uruguay </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<ol start="3" type="a">
<li>The youngest person aboard the titanic was in fact a female at 0.17 years, which is just over 2 months (thanks Google!).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (d)</span></span>
<span id="cb52-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a aria-hidden="true" tabindex="-1"></a>titanic_fare_age <span class="op">=</span> titanic.sort_values(by <span class="op">=</span> [<span class="st">'fare'</span>, <span class="st">'age'</span>], ascending <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ticket </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> fare </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> cabin </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> embarked </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> home.dest </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Barkworth, Mr. Algernon Henry Wilson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 27042 </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:left;"> A23 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Hessle, Yorks </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> B </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 61 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cavendish, Mrs. Tyrell William (Julia Florence Siegel) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 76 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 19877 </td>
   <td style="text-align:right;"> 78.8500 </td>
   <td style="text-align:left;"> C46 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Little Onn Hall, Staffs </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1235 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Svensson, Mr. Johan </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 74 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 347060 </td>
   <td style="text-align:right;"> 7.7750 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 135 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Goldschmidt, Mr. George B </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17754 </td>
   <td style="text-align:right;"> 34.6542 </td>
   <td style="text-align:left;"> A5 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Artagaveytia, Mr. Ramon </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17609 </td>
   <td style="text-align:right;"> 49.5042 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Montevideo, Uruguay </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<ol start="5" type="a">
<li>We see that there were actually two people aged 49 who paid no fare to board the titanic, and they were the oldest to do so.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="revisiting-parameters-and-arguments" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Revisiting parameters and arguments</h1>
<p>I mentioned earlier that not including parameter names can sometimes confuse Python when it comes to the order in which they can be specified for larger functions. Now we will see this in practice.</p>
<section id="important-example" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="important-example">Important Example</h2>
<p>Parameters are key words that tell python what the following argument relates to. We have two in the code below:</p>
<ul>
<li><p>by= is a parameter and the string representing the column “IncidentNominalCost(£)” is the argument.</p></li>
<li><p>ascending= is a parameter and the Boolean value False is the argument</p></li>
</ul>
<p>If we don’t specify parameters Python will assume our arguments are in the order specified in the Signature (press shift + tab with your cursor in .sort_values() to see this), and because of this the code below won’t work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This code will give us an error!</span></span>
<span id="cb53-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># After you've tried it, you may want to comment it out!</span></span>
<span id="cb53-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a aria-hidden="true" tabindex="-1"></a>animals_sorted <span class="op">=</span> animals.sort_values(<span class="st">"IncidentNominalCost(£)"</span>, <span class="va">False</span>)</span>
<span id="cb53-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a aria-hidden="true" tabindex="-1"></a>animals_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our first argument IncidentNominalCost(£) maps directly to the by= parameter as expected. However, Python assumes the second argument False relates to the axis = parameter; which in some versions isn’t a valid argument, and in some pandas versions is treated effectively as axis =0.</p>
<p>It is personal preference if you use parameters before your arguments. It is considered good practice, and can make your code more readable, especially to new coders. We would strongly advise doing so.</p>
<p>As a bonus when you use parameters with your arguments you can pass them in any order as Python no longer relies on it being a positional based argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a aria-hidden="true" tabindex="-1"></a>animals_sorted <span class="op">=</span> animals.sort_values(ascending<span class="op">=</span><span class="va">False</span>, by<span class="op">=</span><span class="st">"IncidentNominalCost(£)"</span>)</span>
<span id="cb54-2"><a aria-hidden="true" tabindex="-1"></a>animals_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 4450 </td>
   <td style="text-align:left;"> 098141-28072016 </td>
   <td style="text-align:left;"> 28/07/2016 13:49 </td>
   <td style="text-align:right;"> 2016 </td>
   <td style="text-align:left;"> 2016/17 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 326 </td>
   <td style="text-align:right;"> 3912 </td>
   <td style="text-align:left;"> CAT STUCK WITHIN WALL SPACE  RSPCA IN ATTENDANCE </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - 4 to 9 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving domestic animal - Other action </td>
   <td style="text-align:left;"> Camden </td>
   <td style="text-align:left;"> Kentish Town </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2542 </td>
   <td style="text-align:left;"> 48360131 </td>
   <td style="text-align:left;"> 19/04/2013 07:01 </td>
   <td style="text-align:right;"> 2013 </td>
   <td style="text-align:left;"> 2013/14 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 290 </td>
   <td style="text-align:right;"> 3480 </td>
   <td style="text-align:left;"> FOAL IN RIVER WATER LEVEL ONE IMPLEMENTED </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3757 </td>
   <td style="text-align:left;"> 62700151 </td>
   <td style="text-align:left;"> 22/05/2015 11:34 </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:left;"> 2015/16 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 2980 </td>
   <td style="text-align:left;"> HORSE FALLEN INTO SWIMMING  POOL </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Other outdoor structures </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Biggin Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5568 </td>
   <td style="text-align:left;"> 092389-09072018 </td>
   <td style="text-align:left;"> 09/07/2018 08:35 </td>
   <td style="text-align:right;"> 2018 </td>
   <td style="text-align:left;"> 2018/19 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 333 </td>
   <td style="text-align:right;"> 2664 </td>
   <td style="text-align:left;"> HORSE TRAPPED IN DOORWAY ADDITIONAL FRU REQUESTED FROM SCENE - SILENT APPROACH </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy domestic animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3143 </td>
   <td style="text-align:left;"> 49076141 </td>
   <td style="text-align:left;"> 22/04/2014 09:54 </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:left;"> 2014/15 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 295 </td>
   <td style="text-align:right;"> 2655 </td>
   <td style="text-align:left;"> KITTEN TRAPPED IN CHIMNEY </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - Up to 3 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist trapped domestic animal </td>
   <td style="text-align:left;"> Hounslow </td>
   <td style="text-align:left;"> Feltham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AT </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p><a id="subsetting" href=""></a></p>
</section>
</section>
<section id="subsetting" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Subsetting</h1>
<section id="selecting-single-columns" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="selecting-single-columns"><span class="header-section-number">6.1</span> Selecting Single Columns</h2>
<p>Sometimes we will want to work with smaller “cut down” DataFrames that contain fewer columns. As we saw earlier the simplest way to select a column from a DataFrame is to use the name of the column in the indexing brackets [].</p>
<section id="example-11" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="example-11"><span class="header-section-number">6.1.1</span> Example</h3>
<p>Here I am creating a new Series called ‘animal_grp_parent’ using the ‘AnimalGroupParent’ column from the animals DataFrame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a aria-hidden="true" tabindex="-1"></a>animal_grp_parent <span class="op">=</span> animals[<span class="st">'AnimalGroupParent'</span>]</span>
<span id="cb55-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a aria-hidden="true" tabindex="-1"></a>animal_grp_parent.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0       Dog
1       Fox
2       Dog
3     Horse
4    Rabbit
Name: AnimalGroupParent, dtype: object</code></pre>
</div>
</div>
</section>
<section id="exercise-10" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="exercise-10"><span class="header-section-number">6.1.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<ol type="a">
<li><p>Select the fare column from the titanic DataFrame and name it titanic_fare.</p></li>
<li><p>Randomly Sample 12 rows from the titanic_fare object you created.</p></li>
</ol>
</div>
<div id="tabset-7-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb57-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a aria-hidden="true" tabindex="-1"></a>titanic_fare <span class="op">=</span> titanic[<span class="st">"fare"</span>]</span>
<span id="cb57-4"><a aria-hidden="true" tabindex="-1"></a>titanic_fare.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    211.3375
1    151.5500
2    151.5500
3    151.5500
4    151.5500
Name: fare, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b) </span></span>
<span id="cb59-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a aria-hidden="true" tabindex="-1"></a>titanic_fare.sample(n <span class="op">=</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>36       55.0000
309     164.8667
1225         NaN
744      10.1708
239      50.4958
610       9.4750
931       7.7375
1006      7.8792
942       7.2250
1001     23.2500
581       0.0000
584      13.0000
Name: fare, dtype: float64</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="selecting-multiple-columns" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="selecting-multiple-columns"><span class="header-section-number">6.2</span> Selecting Multiple Columns</h2>
<section id="example-12" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="example-12"><span class="header-section-number">6.2.1</span> Example</h3>
<p>Similarly as with <strong>sorting</strong> by multiple columns, we can select multiple columns by providing them in a list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of columns</span></span>
<span id="cb61-2"><a aria-hidden="true" tabindex="-1"></a>my_list_of_columns <span class="op">=</span> [ <span class="st">"DateTimeOfCall"</span>, <span class="st">"AnimalGroupParent"</span>, <span class="st">"IncidentNominalCost(£)"</span>]</span>
<span id="cb61-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Pass that list to my indexing brackets, creating a dataframe</span></span>
<span id="cb61-5"><a aria-hidden="true" tabindex="-1"></a>animal_small_df <span class="op">=</span> animals[my_list_of_columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can, however do this in one step by using two sets of square brackets next to each other. It’s important to realise that they are doing two separate roles:</p>
<ul>
<li>Our first set is selecting or indexing from the animals DataFrame.</li>
<li>Our second set is creating a list of our columns we wish to select.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This gives the same result as the cell above.</span></span>
<span id="cb62-2"><a aria-hidden="true" tabindex="-1"></a>animal_small_df <span class="op">=</span> animals[[ <span class="st">"DateTimeOfCall"</span>, <span class="st">"AnimalGroupParent"</span>, <span class="st">"IncidentNominalCost(£)"</span>]]</span>
<span id="cb62-3"><a aria-hidden="true" tabindex="-1"></a>animal_small_df.sample(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 5353 </td>
   <td style="text-align:left;"> 02/04/2018 16:38 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:right;"> 333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 836 </td>
   <td style="text-align:left;"> 11/06/2010 23:44 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1323 </td>
   <td style="text-align:left;"> 22/04/2011 13:23 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2647 </td>
   <td style="text-align:left;"> 11/06/2013 11:21 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:right;"> 290 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 822 </td>
   <td style="text-align:left;"> 02/06/2010 20:57 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1334 </td>
   <td style="text-align:left;"> 26/04/2011 07:40 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Two important things to note are the following:</p>
<ul>
<li><p>When we return one column we get a Series object (as DataFrames are collections of Series objects)</p></li>
<li><p>When we return more than one column we get a DataFrame.</p></li>
</ul>
</section>
<section id="exercise-12" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="exercise-12"><span class="header-section-number">6.2.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<ol type="a">
<li><p>Select the name, sex, age and survived column from the titanic DataFrame, naming it accordingly.</p></li>
<li><p>Create two sub DataFrames from your answer to part (a), one containing sex and age and another containing name and survived, naming them accordingly.</p></li>
</ol>
</div>
<div id="tabset-8-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb63-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a aria-hidden="true" tabindex="-1"></a>titanic_select <span class="op">=</span> titanic[[<span class="st">"name"</span>,<span class="st">"sex"</span>,<span class="st">"age"</span>, <span class="st">"survived"</span>]]</span>
<span id="cb63-4"><a aria-hidden="true" tabindex="-1"></a>titanic_select.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb64-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a aria-hidden="true" tabindex="-1"></a>titanic_ages_sexes <span class="op">=</span> titanic_select[[<span class="st">"age"</span>, <span class="st">"sex"</span>]]</span>
<span id="cb64-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a aria-hidden="true" tabindex="-1"></a>titanic_names_survived <span class="op">=</span> titanic_select[[<span class="st">"name"</span>, <span class="st">"survived"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Note that you may see people selecting columns using dataframe.column_name, which is a legal practice, but certainly not a recommended one!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This will work - but is not good practice!</span></span>
<span id="cb65-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a aria-hidden="true" tabindex="-1"></a>titanic.sex.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    female
1      male
2    female
3      male
4    female
Name: sex, dtype: object</code></pre>
</div>
</div>
<p>We don’t recommend this because it looks too much like an attribute or method. This also won’t work if you had a column that was something like mean as Python can’t determine if you mean the column mean or the method .mean().</p>
<p>There’s no ambiguity with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a aria-hidden="true" tabindex="-1"></a>dataframe[“column”]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which is why we will always recommend it over the dataframe.column_name.</p>
</section>
</section>
<section id="selecting-on-data-type" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="selecting-on-data-type"><span class="header-section-number">6.3</span> Selecting on data type</h2>
<p>We can also use the method .select_dtypes() if we want to include or exclude specific kinds of data from our dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Select just the object columns</span></span>
<span id="cb68-2"><a aria-hidden="true" tabindex="-1"></a>animal_object_cols <span class="op">=</span> animals.select_dtypes(include<span class="op">=</span>[<span class="st">"object"</span>])</span>
<span id="cb68-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Return the top of the animal columns</span></span>
<span id="cb68-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a aria-hidden="true" tabindex="-1"></a>animal_object_cols.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 139091 </td>
   <td style="text-align:left;"> 01/01/2009 03:01 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:left;"> DOG WITH JAW TRAPPED IN MAGAZINE RACK,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Norbury </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 275091 </td>
   <td style="text-align:left;"> 01/01/2009 08:51 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH FOX TRAPPED,B15 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:left;"> Railings </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2075091 </td>
   <td style="text-align:left;"> 04/01/2009 10:07 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:left;"> DOG CAUGHT IN DRAIN,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Pipe or drain </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Wallington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2872091 </td>
   <td style="text-align:left;"> 05/01/2009 12:27 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:left;"> HORSE TRAPPED IN LAKE,J17 </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Intensive Farming Sheds (chickens, pigs etc) </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Ruislip </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3553091 </td>
   <td style="text-align:left;"> 06/01/2009 15:23 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:left;"> RABBIT TRAPPED UNDER SOFA,B15 </td>
   <td style="text-align:left;"> Rabbit </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Harold Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We must specify our include data types as a list here, even if we’re just specifying one value. It’s just the way this function was written (it will tell you this in the help documentation).</p>
<ul>
<li>“object” includes our string columns, I could also use “O” here.</li>
<li>“float64” and “int64” will select floating point numbers and integer numbers respectively.</li>
<li>If you have the numpy package loaded (import numpy as np) you can use np.number (no quotes) to return numerical data.</li>
</ul>
<p>You can even use the parameter exclude= which may be easier if you wish to omit just one data type.</p>
<section id="exercise-14" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="exercise-14"><span class="header-section-number">6.3.1</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Create a new DataFrame titanic_int_no_float where we include all integer columns, but exclude all float columns.</p>
</div>
<div id="tabset-9-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a aria-hidden="true" tabindex="-1"></a>titanic_int_no_float <span class="op">=</span> titanic.select_dtypes(include <span class="op">=</span> [<span class="st">'int64'</span>], exclude <span class="op">=</span> [<span class="st">'float64'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</div>
<p><a id="filter" href=""></a></p>
</section>
</section>
</section>
<section id="filtering" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Filtering</h1>
<section id="filtering-by-index-position" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="filtering-by-index-position"><span class="header-section-number">7.1</span> Filtering by Index Position</h2>
<p>We can achieve really simple filtering by passing a range to the DataFrame indexer.</p>
<section id="example-13" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="example-13"><span class="header-section-number">7.1.1</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 139091 </td>
   <td style="text-align:left;"> 01/01/2009 03:01 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 510 </td>
   <td style="text-align:left;"> DOG WITH JAW TRAPPED IN MAGAZINE RACK,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Norbury </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 275091 </td>
   <td style="text-align:left;"> 01/01/2009 08:51 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH FOX TRAPPED,B15 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:left;"> Railings </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2075091 </td>
   <td style="text-align:left;"> 04/01/2009 10:07 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> DOG CAUGHT IN DRAIN,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Pipe or drain </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Wallington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2872091 </td>
   <td style="text-align:left;"> 05/01/2009 12:27 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> HORSE TRAPPED IN LAKE,J17 </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Intensive Farming Sheds (chickens, pigs etc) </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Ruislip </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3553091 </td>
   <td style="text-align:left;"> 06/01/2009 15:23 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> RABBIT TRAPPED UNDER SOFA,B15 </td>
   <td style="text-align:left;"> Rabbit </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Harold Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Which returns us the same rows as .head(). We can however modify this to return any range of rows within the DataFrame we like - for example the middle of our DataFrame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="dv">200</span>:<span class="dv">210</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNumber </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> DateTimeOfCall </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> CalYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinYear </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> TypeOfIncident </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpCount </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> PumpHoursTotal </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FinalDescription </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalGroupParent </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PropertyType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> SpecialServiceType </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Borough </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> StnGroundName </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> AnimalClass </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 201 </td>
   <td style="text-align:left;"> 81770091 </td>
   <td style="text-align:left;"> 15/05/2009 16:50 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> CAT STUCK ON FENCE,B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Bridge </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Tower Hamlets </td>
   <td style="text-align:left;"> Bethnal Green </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BG </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 202 </td>
   <td style="text-align:left;"> 82208091 </td>
   <td style="text-align:left;"> 16/05/2009 13:20 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> DOG TRAPPED UNDER CAR,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Car </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Brent </td>
   <td style="text-align:left;"> West Hampstead </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AE </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 203 </td>
   <td style="text-align:left;"> 82239091 </td>
   <td style="text-align:left;"> 16/05/2009 14:28 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> ROAD TRAFFIC ACCIDENT,B1 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Car </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Orpington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 204 </td>
   <td style="text-align:left;"> 82314091 </td>
   <td style="text-align:left;"> 16/05/2009 17:09 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> DOG STUCK IN FOX HOLE,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Domestic garden (vegetation not equipment) </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Redbridge </td>
   <td style="text-align:left;"> Hainault </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BC </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 205 </td>
   <td style="text-align:left;"> 82769091 </td>
   <td style="text-align:left;"> 17/05/2009 09:54 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> CAT STUCK BEHIND TOILET,B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - 4 to 9 storeys </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Addington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 206 </td>
   <td style="text-align:left;"> 83410091 </td>
   <td style="text-align:left;"> 18/05/2009 13:44 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1040 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH PIGEON TRAPPED IN CHIMNEY,B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Redbridge </td>
   <td style="text-align:left;"> Ilford </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00BC </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 207 </td>
   <td style="text-align:left;"> 83903091 </td>
   <td style="text-align:left;"> 19/05/2009 10:38 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH 2  DUCKLINGS TRAPPED BEWTEEN CAVITY WALL,B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Multi-Storey car park </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Bird </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 208 </td>
   <td style="text-align:left;"> 83922091 </td>
   <td style="text-align:left;"> 19/05/2009 11:35 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> ASSIST RSPCA, B15 </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Bridge </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 209 </td>
   <td style="text-align:left;"> 84125091 </td>
   <td style="text-align:left;"> 19/05/2009 17:46 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH CAT UP A TREE,B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Domestic garden (vegetation not equipment) </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Ealing </td>
   <td style="text-align:left;"> Ealing </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AJ </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 210 </td>
   <td style="text-align:left;"> 84176091 </td>
   <td style="text-align:left;"> 19/05/2009 19:07 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> G561 RUNNING CALL TO PIGEON TRAPPED IN NETTING,B15,RC </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> Vehicle Repair Workshop </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Bird </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Heathrow </td>
   <td style="text-align:left;"> Bird </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>However, we can do more involved, conditional filtering using pandas, which is one of the key processes for any Data Analysis task.</p>
</section>
</section>
<section id="single-conditional-filtering" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="single-conditional-filtering"><span class="header-section-number">7.2</span> Single Conditional Filtering</h2>
<p>Pandas filters data in a two step process.</p>
<ol type="1">
<li>It creates a mask that specifies inclusion or exclusion for each row in the DataFrame.</li>
<li>Apply the mask on to the DataFrame to return the subset of rows that are included.</li>
</ol>
<p>In the code below I will create a few simple DataFrames to illustrate my point. Don’t worry too much about how these bits of code works; as previously mentioned you’ll often be working with much larger DataFrames that you’ll load in using one of the pd.read_ commands.</p>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:left;"> name </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Catalie Portman </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Pico de Gato </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Chewbarka </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<section id="example-14" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="example-14"><span class="header-section-number">7.2.1</span> Example</h3>
<p>I want to filter so I just have ‘Cat’ Rows.</p>
<p>My <strong>condition</strong> can be written like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> cat_dog[<span class="st">'animal'</span>] <span class="op">==</span> <span class="st">'Cat'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>I am assigning my output to the variable mask with the single = sign</li>
<li>The column I want to look for values in is “animal” from the catdog Dataframe - catdog[“animal”]</li>
<li>From that column I want to find values that meet my condition – I state this with the double equals ==</li>
<li>Finally I am telling Pandas what value I want to find; a string containing “Cat”</li>
</ul>
<p>If we run the cell we can see the output is a Boolean Series, our True and False values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Run me to see the Series of Boolean values</span></span>
<span id="cb73-2"><a aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0     True
1     True
2    False
3     True
Name: animal, dtype: bool</code></pre>
</div>
</div>
<p>Just to make things clearer, Here I’ve added this series as a new column on our cat_dog DataFrame to demonstrate.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">animal</th>
<th style="text-align: center;">name</th>
<th>included</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Catalie Portman</td>
<td>True</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Pico de Gato</td>
<td>True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Dog</td>
<td style="text-align: center;">Chewbarka</td>
<td>False</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Sir Isaac Mewton</td>
<td>True</td>
</tr>
</tbody>
</table>
<p>We can see where the value in the animal column was “Cat”; the mask column is True. Where the value was not cat (e.g “Dog”) the mask column is False. However I want to return just the rows where the value in mask was True.</p>
<p>To do this we apply the mask variable on to the cat_dog Dataframe using our indexing or selection brackets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a aria-hidden="true" tabindex="-1"></a>just_cats <span class="op">=</span> cat_dog[mask]</span>
<span id="cb75-2"><a aria-hidden="true" tabindex="-1"></a>just_cats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  animal              name
0    Cat   Catalie Portman
1    Cat      Pico de Gato
3    Cat  Sir Isaac Mewton</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:left;"> name </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Catalie Portman </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Pico de Gato </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>This will only return the rows where our <strong>conditional filter</strong> equated to True.</p>
<p>This seems a little long but thankfully, rather than create and apply a mask separately we can do the whole filter operation in one step. We teach it this way to break down the process into component parts, before wrapping it up in a one line bow.</p>
</section>
<section id="example-15" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="example-15"><span class="header-section-number">7.2.2</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a aria-hidden="true" tabindex="-1"></a>just_cats <span class="op">=</span> cat_dog[cat_dog[<span class="st">'animal'</span>] <span class="op">==</span> <span class="st">"Cat"</span>]</span>
<span id="cb77-2"><a aria-hidden="true" tabindex="-1"></a>just_cats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  animal              name
0    Cat   Catalie Portman
1    Cat      Pico de Gato
3    Cat  Sir Isaac Mewton</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:left;"> name </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Catalie Portman </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Pico de Gato </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>You’ll notice the cell with the “Dog” value has been dropped.</p>
<p>You’ll also notice that our index has not changed. You will sometimes want to reset the index after filtering to restore it to sequential integers starting at 0 as this can cause some problems in certain circumstances.</p>
</section>
<section id="example-16" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="example-16"><span class="header-section-number">7.2.3</span> Example</h3>
<p>You can do this like so.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a aria-hidden="true" tabindex="-1"></a>just_cats.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-2"><a aria-hidden="true" tabindex="-1"></a>just_cats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  animal              name
0    Cat   Catalie Portman
1    Cat      Pico de Gato
2    Cat  Sir Isaac Mewton</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:left;"> name </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Catalie Portman </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Pico de Gato </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<ul>
<li><p>By default the previous column index is put in as a new column. By using drop=True we can remove this behaviour.</p></li>
<li><p>inplace=True updates the DataFrame in place and is an alternative to overwriting the data with just_cats = just_cats.reset_index(drop=True).</p></li>
</ul>
</section>
</section>
<section id="other-comparison-operators" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="other-comparison-operators"><span class="header-section-number">7.3</span> Other Comparison Operators</h2>
<p>We have seen the equivalence sign “==” thus far, but there are other very useful operators we can utilise when conditional filtering:</p>
<table class="table">
<thead>
<tr class="header">
<th>Symbol</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>==</td>
<td>Is equivalent to</td>
</tr>
<tr class="even">
<td>!=</td>
<td>Does not equal</td>
</tr>
<tr class="odd">
<td>&gt;</td>
<td>Greater than</td>
</tr>
<tr class="even">
<td>&gt;=</td>
<td>Greater than or equivalent too</td>
</tr>
<tr class="odd">
<td>&lt;</td>
<td>Less than</td>
</tr>
<tr class="even">
<td>&lt;=</td>
<td>Less than or equivalent too</td>
</tr>
</tbody>
</table>
<section id="example-17" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="example-17"><span class="header-section-number">7.3.1</span> Example</h3>
<p>Let’s use our animals <strong>DataFrame</strong> to find the rows where IncidentNominalCost(£) is over £1000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Note here we're using the animals DataFrame</span></span>
<span id="cb81-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a aria-hidden="true" tabindex="-1"></a>cost_over_1k <span class="op">=</span> animals[animals[<span class="st">'IncidentNominalCost(£)'</span>] <span class="op">&gt;</span> <span class="dv">1000</span>]</span>
<span id="cb81-4"><a aria-hidden="true" tabindex="-1"></a>cost_over_1k.sample(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 3757 </td>
   <td style="text-align:left;"> 62700151 </td>
   <td style="text-align:left;"> 22/05/2015 11:34 </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:left;"> 2015/16 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 2980 </td>
   <td style="text-align:left;"> HORSE FALLEN INTO SWIMMING  POOL </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Other outdoor structures </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Bromley </td>
   <td style="text-align:left;"> Biggin Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AF </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 874 </td>
   <td style="text-align:left;"> 100611101 </td>
   <td style="text-align:left;"> 26/06/2010 15:29 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 2080 </td>
   <td style="text-align:left;"> CAT TRAPPED IN BIN CHUTE </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - 4 to 9 storeys </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Westminster </td>
   <td style="text-align:left;"> North Kensington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BK </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5289 </td>
   <td style="text-align:left;"> 015772-07022018 </td>
   <td style="text-align:left;"> 07/02/2018 13:54 </td>
   <td style="text-align:right;"> 2018 </td>
   <td style="text-align:left;"> 2017/18 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 328 </td>
   <td style="text-align:right;"> 1312 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH RESCUE OF CAT TRAPPED BETWEEN TWO BUILDINGS RSPCA OFFICER MICHAEL - ON SCENE- FRU </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - Up to 3 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist trapped domestic animal </td>
   <td style="text-align:left;"> Newham </td>
   <td style="text-align:left;"> East Ham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BB </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5693 </td>
   <td style="text-align:left;"> 122783-27082018 </td>
   <td style="text-align:left;"> 27/08/2018 14:39 </td>
   <td style="text-align:right;"> 2018 </td>
   <td style="text-align:left;"> 2018/19 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 333 </td>
   <td style="text-align:right;"> 1332 </td>
   <td style="text-align:left;"> CAT ON 3RD STOREY ROOF - RSPCA IN ATTENDANCE REQUESTING ASSISTANCE ***REQUEST ALP TO ASSIST WITH RES </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Southwark </td>
   <td style="text-align:left;"> West Norwood </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BE </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 989 </td>
   <td style="text-align:left;"> 139163101 </td>
   <td style="text-align:left;"> 14/08/2010 18:57 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1040 </td>
   <td style="text-align:left;"> KITTEN TRAPPED UNDER FLOOR BOARDS </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Newham </td>
   <td style="text-align:left;"> East Ham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BB </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 441 </td>
   <td style="text-align:left;"> 166566091 </td>
   <td style="text-align:left;"> 13/09/2009 13:14 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2009/10 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1300 </td>
   <td style="text-align:left;"> HORSE STUCK IN RESERVOIR </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here we have done the following:</p>
<ul>
<li>Assigned a new name cost_over_1k which will hold our output</li>
<li>Give our DataFrame name, and our indexing or selection brackets: animals[]</li>
<li>The column we want to look for values in is ”IncidentNominalCost” from the Animals Dataframe animals[‘IncidentNominalCost(£)’]</li>
<li>The condition I want is &gt; 1000 , greater than a thousand. As this is a numeric column I can just specify the number.</li>
<li>Printing out the variable, using .sample(6) method to display 6 rows of the new DataFrame.</li>
</ul>
</section>
<section id="exercise-16" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="exercise-16"><span class="header-section-number">7.3.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<ol type="a">
<li><p>Filter the titanic DataFrame by sex, returning only the rows where this is female. Name this something appropriate</p></li>
<li><p>Filter the titanic DataFrame to return the rows where the passenger age is smaller than 40 (It is useful to practice these without the exact columns to filter by given).</p></li>
<li><p>Filter the titanic DataFrame, returning only the rows where the fare paid is at least £30.50 (Hint: which operator would ‘at least’ correspond to?)</p></li>
</ol>
</div>
<div id="tabset-10-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb82-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a aria-hidden="true" tabindex="-1"></a>titanic_female <span class="op">=</span> titanic[titanic[<span class="st">'sex'</span>] <span class="op">==</span>  <span class="st">"female"</span>]</span>
<span id="cb82-4"><a aria-hidden="true" tabindex="-1"></a>titanic_female.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Andrews, Miss. Kornelia Theodosia </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 13502 </td>
   <td style="text-align:right;"> 77.9583 </td>
   <td style="text-align:left;"> D7 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Hudson, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Appleton, Mrs. Edward Dale (Charlotte Lamson) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 11769 </td>
   <td style="text-align:right;"> 51.4792 </td>
   <td style="text-align:left;"> C101 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Bayside, Queens, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> D </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb83-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a aria-hidden="true" tabindex="-1"></a>titanic_younger <span class="op">=</span> titanic[titanic[<span class="st">'age'</span>] <span class="op">&lt;</span> <span class="dv">40</span>]</span>
<span id="cb83-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a aria-hidden="true" tabindex="-1"></a>titanic_younger.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (c) At least means bigger than or equal to that value</span></span>
<span id="cb84-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a aria-hidden="true" tabindex="-1"></a>titanic_fares <span class="op">=</span> titanic[titanic[<span class="st">'fare'</span>] <span class="op">&gt;=</span> <span class="fl">30.50</span>]</span>
<span id="cb84-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a aria-hidden="true" tabindex="-1"></a>titanic_fares.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-conditional-filtering" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="multiple-conditional-filtering"><span class="header-section-number">7.4</span> Multiple Conditional Filtering</h2>
<p>Just as we can filter by one condition we can also filter by multiple conditions. Let’s add in a new column, representing age to the cat_dog DataFrame.</p>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>When we want to filter on more than one condition, we have to consider how those conditions relate to each other in terms of what is included and what is excluded from the final filtering.</p>
<ul>
<li><p>AND relationships use the &amp; symbol (Shift and 7 on the keyboard) and require <strong>both</strong> or <strong>all</strong> conditions to evaluate to True.</p></li>
<li><p>OR relationships use the | symbol (Alt and 124) and require <strong>one</strong> of the conditions to evaluate to True</p></li>
</ul>
<p>Below is a “Truth table” that can be handy as a look up.</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 20%">
<col style="width: 29%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Condition 1</th>
<th style="text-align: center;">Condition 2</th>
<th style="text-align: center;">&amp; (AND) Equates to</th>
<th style="text-align: center;">| (OR) Equates to</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">True</td>
<td style="text-align: center;">True</td>
<td style="text-align: center;">True</td>
<td style="text-align: center;">True</td>
</tr>
<tr class="even">
<td style="text-align: center;">True</td>
<td style="text-align: center;">False</td>
<td style="text-align: center;">False</td>
<td style="text-align: center;">True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">False</td>
<td style="text-align: center;">True</td>
<td style="text-align: center;">False</td>
<td style="text-align: center;">True</td>
</tr>
<tr class="even">
<td style="text-align: center;">False</td>
<td style="text-align: center;">False</td>
<td style="text-align: center;">False</td>
<td style="text-align: center;">False</td>
</tr>
</tbody>
</table>
<section id="example-18" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="example-18"><span class="header-section-number">7.4.1</span> Example</h3>
<p>Now that we have an age column, we can now select all Cats that are older than 4. Again, in this example we will create a mask so we can see what Boolean values are happening behind the scenes, but in the exercises we will do this in one line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create my mask</span></span>
<span id="cb85-2"><a aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (cat_dog[<span class="st">'animal'</span>] <span class="op">==</span> <span class="st">"Cat"</span>) <span class="op">&amp;</span> (cat_dog[<span class="st">'age'</span>] <span class="op">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb85-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># have a look at the mask</span></span>
<span id="cb85-5"><a aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    False
1     True
2    False
3     True
4    False
dtype: bool</code></pre>
</div>
</div>
<p>This is quite overwhelming upon first viewing, let’s break it down a little bit!</p>
<ul>
<li><p>I am assigning my output to the variable mask with a single = sign.</p></li>
<li><p>My first conditional statement:</p>
<ul>
<li>Has round brackets surrounding it (</li>
<li>The first column I want to look for values in is “animal” from the catdog Dataframe - catdog[“animal”]</li>
<li>From that column I want to find values that meet my condition, which I state with the double equals ==</li>
<li>Finally I am telling pandas what value I want to find; a string containing “Cat”</li>
<li>My first condition complete I close my round brackets )</li>
</ul></li>
<li><p>I use a symbol to represent the relationship between my conditions. Here an ampersand - &amp; (Shift and 7) is used to represent AND</p></li>
<li><p>My second conditional statement:</p>
<ul>
<li>Has round brackets surrounding it (</li>
<li>The first column I want to look for values in is “age” from the catdog Dataframe - catdog[“age”]</li>
<li>From that column I want to find values that are greater than my condition, which I state with the &gt;</li>
<li>Finally I am telling Pandas what value I want to find; an int 4</li>
<li>My second condition complete I close my round brackets )</li>
</ul></li>
</ul>
<p>Let’s look at the mask values alongside the DataFrame:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">animal</th>
<th style="text-align: center;">name</th>
<th>age</th>
<th>included</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Catalie Portman</td>
<td>3</td>
<td>False</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Pico de Gato</td>
<td>5</td>
<td>True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Dog</td>
<td style="text-align: center;">Chewbarka</td>
<td>1</td>
<td>False</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Sir Isaac Mewton</td>
<td>7</td>
<td>True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">Dog</td>
<td style="text-align: center;">K9</td>
<td>11</td>
<td>False</td>
</tr>
</tbody>
</table>
<p>And when we apply the mask to the DataFrame we can see the filtered Dataframe - with only Cats over 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (cat_dog[<span class="st">'animal'</span>] <span class="op">==</span> <span class="st">"Cat"</span>) <span class="op">&amp;</span> (cat_dog[<span class="st">'age'</span>] <span class="op">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb87-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a aria-hidden="true" tabindex="-1"></a>cats_over_4 <span class="op">=</span> cat_dog[mask]</span>
<span id="cb87-4"><a aria-hidden="true" tabindex="-1"></a>cats_over_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name animal  age
1      Pico de Gato    Cat    5
3  Sir Isaac Mewton    Cat    7</code></pre>
</div>
</div>
<p>To do this in one line, we reference the DataFrame we are selecting from, and then place our filter condition within the indexing or selection brackets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a aria-hidden="true" tabindex="-1"></a>cats_over_4 <span class="op">=</span> cat_dog[(cat_dog[<span class="st">"animal"</span>] <span class="op">==</span> <span class="st">"Cat"</span>) <span class="op">&amp;</span> (cat_dog[<span class="st">"age"</span>] <span class="op">&gt;</span> <span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>If we can use the AND condition (&amp;) we can also use the OR condition where only one of the conditions must be met to evaluate to True.</p>
<p>The OR condition is represented by a vertical bar symbol ( | ) – press shift and the backslash.</p>
<p>Lets add a condition where the animal is a cat <strong>OR</strong> the age is greater than 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create my mask</span></span>
<span id="cb90-2"><a aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (cat_dog[<span class="st">"animal"</span>] <span class="op">==</span> <span class="st">"Cat"</span>) <span class="op">|</span> (cat_dog[<span class="st">"age"</span>] <span class="op">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb90-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># View mask</span></span>
<span id="cb90-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0     True
1     True
2    False
3     True
4     True
dtype: bool</code></pre>
</div>
</div>
<p>Let’s look at the mask values alongside the DataFrame:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">animal</th>
<th style="text-align: center;">name</th>
<th>age</th>
<th>included</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Catalie Portman</td>
<td>3</td>
<td>True</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Pico de Gato</td>
<td>5</td>
<td>True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Dog</td>
<td style="text-align: center;">Chewbarka</td>
<td>1</td>
<td>False</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Cat</td>
<td style="text-align: center;">Sir Isaac Mewton</td>
<td>7</td>
<td>True</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">Dog</td>
<td style="text-align: center;">K9</td>
<td>11</td>
<td>True</td>
</tr>
</tbody>
</table>
<p>Catalie Portman now evaluates to True. While she is younger than 3 she is a Cat, and by meeting one of the conditions, she is included.</p>
<p>K9 also evaluates to True. He is not a cat; but meets the age condition by being older than 4 and so is included.</p>
<p>We can of course apply this mask to filter the DataFrame</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a aria-hidden="true" tabindex="-1"></a>cats_or_over4 <span class="op">=</span> cat_dog[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Or do the whole action in one line of code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a aria-hidden="true" tabindex="-1"></a>cats_or_over4 <span class="op">=</span> cat_dog[(cat_dog[<span class="st">"animal"</span>] <span class="op">==</span> <span class="st">"Cat"</span>) <span class="op">|</span> (cat_dog[<span class="st">"age"</span>] <span class="op">&gt;</span> <span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here are some more examples using the titanic DataFrame.</p>
<p>Here we are filtering for survivors (value 1), who were female. Using an AND (&amp;) condition</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a aria-hidden="true" tabindex="-1"></a>female_survivors <span class="op">=</span> titanic[(titanic[<span class="st">"survived"</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (titanic[<span class="st">"sex"</span>] <span class="op">==</span> <span class="st">"female"</span>)]</span>
<span id="cb94-2"><a aria-hidden="true" tabindex="-1"></a>female_survivors.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1260 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Turja, Miss. Anna Sofia </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 4138 </td>
   <td style="text-align:right;"> 9.8417 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 15 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1261 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Turkula, Mrs. (Hedwig) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 4134 </td>
   <td style="text-align:right;"> 9.5875 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 15 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1286 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Whabee, Mrs. George Joseph (Shawneene Abi-Saab) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2688 </td>
   <td style="text-align:right;"> 7.2292 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> C </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1290 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Wilkes, Mrs. James (Ellen Needs) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 363272 </td>
   <td style="text-align:right;"> 7.0000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1300 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Yasbeck, Mrs. Antoni (Selini Alexander) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2659 </td>
   <td style="text-align:right;"> 14.4542 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>And here we are filtering for those with more than 3 sibling/spouses (sibsp) on board or who paid more than £400 for their fare.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a aria-hidden="true" tabindex="-1"></a>siblings_or_expensive <span class="op">=</span> titanic[(titanic[<span class="st">'sibsp'</span>] <span class="op">&gt;</span> <span class="dv">3</span>) <span class="op">|</span> (titanic[<span class="st">'fare'</span>] <span class="op">&gt;</span> <span class="dv">400</span>)]</span>
<span id="cb95-2"><a aria-hidden="true" tabindex="-1"></a>siblings_or_expensive.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 49 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cardeza, Mr. Thomas Drake Martinez </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> PC 17755 </td>
   <td style="text-align:right;"> 512.3292 </td>
   <td style="text-align:left;"> B51 B53 B55 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Austria-Hungary / Germantown, Philadelphia, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cardeza, Mrs. James Warburton Martinez (Charlotte Wardle Drake) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> PC 17755 </td>
   <td style="text-align:right;"> 512.3292 </td>
   <td style="text-align:left;"> B51 B53 B55 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Germantown, Philadelphia, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 183 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Lesurer, Mr. Gustave J </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17755 </td>
   <td style="text-align:right;"> 512.3292 </td>
   <td style="text-align:left;"> B101 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 302 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Ward, Miss. Anna </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17755 </td>
   <td style="text-align:right;"> 512.3292 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 622 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Andersson, Master. Sigvard Harald Elias </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 347082 </td>
   <td style="text-align:right;"> 31.2750 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Sweden Winnipeg, MN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="exercise-18" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="exercise-18"><span class="header-section-number">7.4.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<ol type="a">
<li><p>Filter the animals DataFrame where the IncidentNominalCost(£) Column was less than £400 <strong>and</strong> where the Borough column value is Croydon.</p></li>
<li><p>Filter the animals DataFrame where the ‘PropertyType’ was “River/canal” <strong>or</strong> the “PumpHoursTotal” was at most 8.</p></li>
</ol>
</div>
<div id="tabset-11-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb96-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a aria-hidden="true" tabindex="-1"></a>cost_u400_croydon <span class="op">=</span> animals[(animals[<span class="st">'IncidentNominalCost(£)'</span>] <span class="op">&lt;</span> <span class="dv">400</span>) <span class="op">&amp;</span> (animals[<span class="st">'Borough'</span>] <span class="op">==</span> <span class="st">"Croydon"</span>)]</span>
<span id="cb96-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a aria-hidden="true" tabindex="-1"></a>cost_u400_croydon.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 275091 </td>
   <td style="text-align:left;"> 01/01/2009 08:51 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH FOX TRAPPED,B15 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:left;"> Railings </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:left;"> 4306091 </td>
   <td style="text-align:left;"> 07/01/2009 13:48 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> SQUIRREL TRAPPED ON WINDOWSILL,B15 </td>
   <td style="text-align:left;"> Squirrel </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Wild animal rescue from height </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Addington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:left;"> 5770091 </td>
   <td style="text-align:left;"> 09/01/2009 13:43 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> CAT STUCK UP TREE,B15 </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Tree scrub </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:left;"> 6270091 </td>
   <td style="text-align:left;"> 10/01/2009 10:09 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> INJURED DOG FOLLOWING RTA,B0 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Road surface/pavement </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Purley </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 44 </td>
   <td style="text-align:left;"> 14784091 </td>
   <td style="text-align:left;"> 25/01/2009 15:27 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ANIMAL IN DISTRESS,B15 </td>
   <td style="text-align:left;"> Unknown - Domestic Animal Or Pet </td>
   <td style="text-align:left;"> Domestic garden (vegetation not equipment) </td>
   <td style="text-align:left;"> Animal rescue from height </td>
   <td style="text-align:left;"> Animal rescue from height - Domestic pet </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb97-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a aria-hidden="true" tabindex="-1"></a>river_pumphours <span class="op">=</span> animals[(animals[<span class="st">'PropertyType'</span>] <span class="op">==</span> <span class="st">"River/canal"</span>) <span class="op">|</span> (animals[<span class="st">'PumpHoursTotal'</span>] <span class="op">&gt;</span> <span class="dv">8</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1289 </td>
   <td style="text-align:left;"> 49189111 </td>
   <td style="text-align:left;"> 06/04/2011 02:03 </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> 2011/12 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 2340 </td>
   <td style="text-align:left;"> HORSE IN RIVER IMPLEMENT WATER RESCUE PROCEDURE LEVEL 2 </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Walthamstow </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1407 </td>
   <td style="text-align:left;"> 82423111 </td>
   <td style="text-align:left;"> 27/05/2011 06:50 </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> 2011/12 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 2340 </td>
   <td style="text-align:left;"> HORSE  TRAPPED IN WATER CHANNEL LINE OPS 2 WATER RESCUE </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Walthamstow </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1477 </td>
   <td style="text-align:left;"> 101755111 </td>
   <td style="text-align:left;"> 29/06/2011 21:04 </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> 2011/12 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 2340 </td>
   <td style="text-align:left;"> DEER IN CANAL - WATER RESCUE LEVEL 2 </td>
   <td style="text-align:left;"> Deer </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Wild animal rescue from water or mud </td>
   <td style="text-align:left;"> Tower Hamlets </td>
   <td style="text-align:left;"> Poplar </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2542 </td>
   <td style="text-align:left;"> 48360131 </td>
   <td style="text-align:left;"> 19/04/2013 07:01 </td>
   <td style="text-align:right;"> 2013 </td>
   <td style="text-align:left;"> 2013/14 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 290 </td>
   <td style="text-align:right;"> 3480 </td>
   <td style="text-align:left;"> FOAL IN RIVER WATER LEVEL ONE IMPLEMENTED </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3143 </td>
   <td style="text-align:left;"> 49076141 </td>
   <td style="text-align:left;"> 22/04/2014 09:54 </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:left;"> 2014/15 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 295 </td>
   <td style="text-align:right;"> 2655 </td>
   <td style="text-align:left;"> KITTEN TRAPPED IN CHIMNEY </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:left;"> Purpose Built Flats/Maisonettes - Up to 3 storeys </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist trapped domestic animal </td>
   <td style="text-align:left;"> Hounslow </td>
   <td style="text-align:left;"> Feltham </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AT </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="some-filter-short-cuts." class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="some-filter-short-cuts."><span class="header-section-number">7.5</span> Some Filter short cuts.</h2>
<p>We can also use some other filters to make life easier.</p>
<section id="example-1-1" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="example-1-1"><span class="header-section-number">7.5.1</span> Example 1</h3>
<p>With the method .isin() we can provide a list of things to filter, here the boat identities [“2”, “C”, “15”].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a aria-hidden="true" tabindex="-1"></a>titanic[titanic[<span class="st">"boat"</span>].isin([<span class="st">"2"</span>, <span class="st">"C"</span>, <span class="st">"15"</span>])].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 56 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Carter, Mr. William Ernest </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113760 </td>
   <td style="text-align:right;"> 120.000 </td>
   <td style="text-align:left;"> B96 B98 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Bryn Mawr, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> C </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 79 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cornell, Mrs. Robert Clifford (Malvina Helen Lamson) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 55 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 11770 </td>
   <td style="text-align:right;"> 25.700 </td>
   <td style="text-align:left;"> C101 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 98 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Douglas, Mrs. Walter Donald (Mahala Dutton) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17761 </td>
   <td style="text-align:right;"> 106.425 </td>
   <td style="text-align:left;"> C86 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Deephaven, MN / Cedar Rapids, IA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 164 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Homer, Mr. Harry ("Mr E Haven") </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 111426 </td>
   <td style="text-align:right;"> 26.550 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Indianapolis, IN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 15 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 170 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Ismay, Mr. Joseph Bruce </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 112058 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:left;"> B52 B54 B56 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Liverpool </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> C </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="example-2-1" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="example-2-1"><span class="header-section-number">7.5.2</span> Example 2</h3>
<p>If dealing with numeric values we can use .between() and specify an upper and lower bound. Here we’re looking where the age column was between 0 and 12.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a aria-hidden="true" tabindex="-1"></a>titanic[titanic[<span class="st">"age"</span>].between(<span class="dv">0</span>, <span class="dv">12</span>)].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ticket </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> fare </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> cabin </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> embarked </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> home.dest </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 54 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Carter, Master. William Thornton II </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 11.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113760 </td>
   <td style="text-align:right;"> 120.0000 </td>
   <td style="text-align:left;"> B96 B98 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Bryn Mawr, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 94 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Dodge, Master. Washington </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 4.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 33638 </td>
   <td style="text-align:right;"> 81.8583 </td>
   <td style="text-align:left;"> A34 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> San Francisco, CA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 273 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Spedden, Master. Robert Douglas </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 6.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 16966 </td>
   <td style="text-align:right;"> 134.5000 </td>
   <td style="text-align:left;"> E34 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Tuxedo Park, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="example-3-1" class="level3" data-number="7.5.3">
<h3 data-number="7.5.3" class="anchored" data-anchor-id="example-3-1"><span class="header-section-number">7.5.3</span> Example 3</h3>
<p>We also have the ~ tilde symbol to invert an expression, this works similarly to the != for does not equal. For example, I can invert the filter for female passengers to return just male passengers.</p>
<p>Note that I have to wrap my conditional statement in round brackets to ensure this works.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="op">~</span>(titanic[<span class="st">"sex"</span>] <span class="op">==</span> <span class="st">"female"</span>)].head()  <span class="co"># Inverts the results of == Female; effectively giving == Male</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pclass </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> survived </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> name </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> sex </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> age </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> sibsp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> parch </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ticket </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> fare </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> cabin </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> embarked </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> home.dest </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Anderson, Mr. Harry </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 48.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 19952 </td>
   <td style="text-align:right;"> 26.5500 </td>
   <td style="text-align:left;"> E12 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Andrews, Mr. Thomas Jr </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 39.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 112050 </td>
   <td style="text-align:right;"> 0.0000 </td>
   <td style="text-align:left;"> A36 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Belfast, NI </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Artagaveytia, Mr. Ramon </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 71.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17609 </td>
   <td style="text-align:right;"> 49.5042 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Montevideo, Uruguay </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>The tilde ~ can be useful for other scenarios, there’s a variety of .is methods for example that do not have an is not equivalent; but we can invert the .is method instead. We’ll see a useful example of that in chapter 5.</p>
</section>
<section id="filtering-text" class="level3" data-number="7.5.4">
<h3 data-number="7.5.4" class="anchored" data-anchor-id="filtering-text"><span class="header-section-number">7.5.4</span> Filtering Text</h3>
<p>So far when we’ve talked about filtering text we do so on exact matches. However, as Python is case sensitive, filtering for “cat” will not show the values “CAT” or “Cat” in our cat_dog DataFrame, should they exist (which they often will in real world data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Lets create our cat_dog DataFrame again with some variation in the capitalisation of "cat"</span></span>
<span id="cb101-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a aria-hidden="true" tabindex="-1"></a>cat_dog_wrong_spelling <span class="op">=</span> pd.DataFrame({<span class="st">"animal"</span>: [<span class="st">"cat"</span>, <span class="st">"Cat"</span>, <span class="st">"Dog"</span>, <span class="st">"cat"</span>, <span class="st">"Dog"</span>, <span class="st">"Rat"</span>, <span class="st">"Bat"</span>] , </span>
<span id="cb101-4"><a aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"name"</span>: [<span class="st">"Catalie Portman"</span>,<span class="st">"Pico de Gato"</span>, <span class="st">"Chewbarka"</span>, <span class="st">"Sir Isaac Mewton"</span>, <span class="st">"K9"</span>, <span class="st">"Roland"</span>, <span class="st">"Vlad"</span>],</span>
<span id="cb101-5"><a aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"age"</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">1</span>, <span class="dv">3</span>]} , </span>
<span id="cb101-6"><a aria-hidden="true" tabindex="-1"></a>                                      columns <span class="op">=</span> [<span class="st">"name"</span>, <span class="st">"animal"</span>, <span class="st">"age"</span>])</span>
<span id="cb101-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a aria-hidden="true" tabindex="-1"></a>cat_dog_wrong_spelling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Roland </td>
   <td style="text-align:left;"> Rat </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Vlad </td>
   <td style="text-align:left;"> Bat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here the filter condition we previously used (== Cat) will only now only return us Pico De Gato</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a aria-hidden="true" tabindex="-1"></a>cat_only_spelling <span class="op">=</span> cat_dog_wrong_spelling[cat_dog_wrong_spelling[<span class="st">"animal"</span>] <span class="op">==</span> <span class="st">"Cat"</span>]</span>
<span id="cb102-2"><a aria-hidden="true" tabindex="-1"></a>cat_only_spelling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Which is not the result we wanted.</p>
</section>
<section id="example-19" class="level3" data-number="7.5.5">
<h3 data-number="7.5.5" class="anchored" data-anchor-id="example-19"><span class="header-section-number">7.5.5</span> Example</h3>
<p>For simple instances we can use the string method str.contains() like in the example below. Here, in our DataFrame, some entries in the “Animal” column have “Cat” and others have “cat”. By using .str.contains(“at”), we can bring in both values because both contain the partial string “at”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to find instances where the string in "animal" contains "at"</span></span>
<span id="cb103-2"><a aria-hidden="true" tabindex="-1"></a>cat_only_spelling <span class="op">=</span> cat_dog_wrong_spelling[cat_dog_wrong_spelling[<span class="st">"animal"</span>].<span class="bu">str</span>.contains(<span class="st">"at"</span>)]</span>
<span id="cb103-3"><a aria-hidden="true" tabindex="-1"></a>cat_only_spelling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> Roland </td>
   <td style="text-align:left;"> Rat </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:left;"> Vlad </td>
   <td style="text-align:left;"> Bat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>This is clearly not foolproof however, as both Rat and Bat also have at in them, and as such are displayed in the output.</p>
<p>In chapter 5 we’ll look at changing the column values and column names to lowercase letters, which would allow a straight forward filter to work in this case.</p>
</section>
</section>
<section id="aside---regular-expressions" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="aside---regular-expressions"><span class="header-section-number">7.6</span> Aside - Regular Expressions</h2>
<p>For more complex cases we can use what is known as Regular Expressions or RegEx in Python to search for partial strings with specified conditions (such as placing where the letters are located, starting with, ending with etc).</p>
<p>We do not cover these in this introduction course; but here are some more resources you may wish to explore. If you have used Regular Expressions in other languages you will find this very familiar.</p>
<p><a href="https://docs.python.org/3/howto/regex.html">RegEx How to</a></p>
<p><a href="https://developers.google.com/edu/python/regular-expressions">Python Regular Expressions</a></p>
<p><a href="https://www.datacamp.com/community/tutorials/python-regular-expression-tutorial">Datacamp RegEx tutorial</a></p>
</section>
<section id="more-filtering-methods" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="more-filtering-methods"><span class="header-section-number">7.7</span> More Filtering Methods</h2>
<p>We’ve looked here at the base Python way of filtering, but as with many things in Python there are other alternatives.</p>
<section id="example-1-2" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="example-1-2"><span class="header-section-number">7.7.1</span> Example 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a aria-hidden="true" tabindex="-1"></a>titanic.query(<span class="st">'fare &gt; 50 &amp; sex == "male"'</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Astor, Col. John Jacob </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 47.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17757 </td>
   <td style="text-align:right;"> 227.5250 </td>
   <td style="text-align:left;"> C62 C64 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> 124 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Baxter, Mr. Quigg Edmond </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 24.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> PC 17558 </td>
   <td style="text-align:right;"> 247.5208 </td>
   <td style="text-align:left;"> B58 B60 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Montreal, PQ </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Beattie, Mr. Thomson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 36.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 13050 </td>
   <td style="text-align:right;"> 75.2417 </td>
   <td style="text-align:left;"> C6 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Winnipeg, MN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> A </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here we use .query() which allows us to type a more SQL style query in words and symbols without utilising our filtering brackets.</p>
</section>
<section id="example-2-2" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="example-2-2"><span class="header-section-number">7.7.2</span> Example 2</h3>
<p>We also have .filter(), which works on the <em>index</em>, rather then the contents! Here I’m looking for like = “1” which will give me index 1 , 11 and 12 as they contain the number 1. Note that axis = 0 means apply to the <strong>rows</strong>, whereas axis = 1 applies to the columns.</p>
<p>So far we’ve worked with indexes that are numerical, from 0 to n; but they can also be text based; and using the pandas .filter() would be useful here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a aria-hidden="true" tabindex="-1"></a>titanic.<span class="bu">filter</span>(like <span class="op">=</span> <span class="st">"1"</span>, axis <span class="op">=</span> <span class="dv">0</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.550 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Astor, Col. John Jacob </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 47.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17757 </td>
   <td style="text-align:right;"> 227.525 </td>
   <td style="text-align:left;"> C62 C64 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> 124 </td>
   <td style="text-align:left;"> NaN </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Astor, Mrs. John Jacob (Madeleine Talmadge Force) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 18.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17757 </td>
   <td style="text-align:right;"> 227.525 </td>
   <td style="text-align:left;"> C62 C64 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Aubart, Mme. Leontine Pauline </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 24.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17477 </td>
   <td style="text-align:right;"> 69.300 </td>
   <td style="text-align:left;"> B35 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Paris, France </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Barber, Miss. Ellen "Nellie" </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 26.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 19877 </td>
   <td style="text-align:right;"> 78.850 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 6 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>You may find even more ways of filtering your data when researching, there’s lots out there!</p>
</section>
</section>
</section>
<section id="deriving-new-columns" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Deriving New Columns</h1>
<p>We create new columns in very similar to filtering them:</p>
<center>
titanic[“new_column”] = 1
</center>
<p>In the example above we are creating a new column in the titanic DataFrame called “new_column”, which will have the constant value of 1 in each row.</p>
<ul>
<li>To create a new column we first give the DataFrame name and use square brackets to specify, as a string our column name, here this is “new_column”.
<ul>
<li>If the column name does not exist in our Dataframe (like in the example) the contents will be placed in a new column, at the end of the DataFrame.</li>
<li>If the column already exists in our DataFrame the contents of that column will be <strong>overwritten</strong>.</li>
</ul></li>
</ul>
<p>We then use the assignment operator “=” and after this is what we fill our column with, in this example it was a constant value of the integer 1.</p>
<p>We’ll now look at various different ways we can fill these new columns.</p>
<section id="other-constant-values" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="other-constant-values"><span class="header-section-number">8.1</span> Other Constant Values</h2>
<p>Some more examples are in the cell below, filling with both floats as well as objects/strings. The syntax remains the same, subsetting the column and assigning it to the value.</p>
<section id="example-20" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="example-20"><span class="header-section-number">8.1.1</span> Example</h3>
<p>As a reminder, our cat_dog dataframe looks as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Let's remind ourselves what cat_dog looks like</span></span>
<span id="cb106-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a aria-hidden="true" tabindex="-1"></a>cat_dog.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Now let’s add some more constant columns!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Let's add new columns</span></span>
<span id="cb107-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a aria-hidden="true" tabindex="-1"></a>cat_dog[<span class="st">"constant_string"</span>] <span class="op">=</span> <span class="st">"mammal"</span>   <span class="co"># adds a string/object constant</span></span>
<span id="cb107-4"><a aria-hidden="true" tabindex="-1"></a>cat_dog[<span class="st">"constant_float"</span>] <span class="op">=</span> <span class="fl">3.2</span> <span class="co"># adds a floating point constant</span></span>
<span id="cb107-5"><a aria-hidden="true" tabindex="-1"></a>cat_dog[<span class="st">"constant_int"</span>] <span class="op">=</span> <span class="dv">2</span>   <span class="co"># adds an interger constant</span></span>
<span id="cb107-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a aria-hidden="true" tabindex="-1"></a>cat_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> constant_string </th>
   <th style="text-align:right;"> constant_float </th>
   <th style="text-align:right;"> constant_int </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="exercise-20" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="exercise-20"><span class="header-section-number">8.1.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Add a new constant column to the animals DataFrame called attended and set the value to be True.</p>
</div>
<div id="tabset-12-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">'attended'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb108-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># View the dataframe</span></span>
<span id="cb108-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a aria-hidden="true" tabindex="-1"></a>animals.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
   <th style="text-align:left;"> attended </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 139091 </td>
   <td style="text-align:left;"> 01/01/2009 03:01 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 510 </td>
   <td style="text-align:left;"> DOG WITH JAW TRAPPED IN MAGAZINE RACK,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Norbury </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 275091 </td>
   <td style="text-align:left;"> 01/01/2009 08:51 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> ASSIST RSPCA WITH FOX TRAPPED,B15 </td>
   <td style="text-align:left;"> Fox </td>
   <td style="text-align:left;"> Railings </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Croydon </td>
   <td style="text-align:left;"> Woodside </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AH </td>
   <td style="text-align:left;"> Outer London </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2075091 </td>
   <td style="text-align:left;"> 04/01/2009 10:07 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> DOG CAUGHT IN DRAIN,B15 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:left;"> Pipe or drain </td>
   <td style="text-align:left;"> Animal rescue from below ground </td>
   <td style="text-align:left;"> Animal rescue from below ground - Domestic pet </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Wallington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Outer London </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2872091 </td>
   <td style="text-align:left;"> 05/01/2009 12:27 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> HORSE TRAPPED IN LAKE,J17 </td>
   <td style="text-align:left;"> Horse </td>
   <td style="text-align:left;"> Intensive Farming Sheds (chickens, pigs etc) </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Ruislip </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3553091 </td>
   <td style="text-align:left;"> 06/01/2009 15:23 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> RABBIT TRAPPED UNDER SOFA,B15 </td>
   <td style="text-align:left;"> Rabbit </td>
   <td style="text-align:left;"> House - single occupancy </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Harold Hill </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>So as you can see, we can set up constant boolean columns as well!</p>
</div>
</div>
</div>
</section>
</section>
<section id="numeric-values" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="numeric-values"><span class="header-section-number">8.2</span> Numeric Values</h2>
<p>We can create numeric columns as well, which are often referred to as ‘calculated columns’ as they can be calculated referencing many other numeric columns.</p>
<section id="example-21" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="example-21"><span class="header-section-number">8.2.1</span> Example</h3>
<p>We can do any form of operations we like here, for example creating the family size of the person. This is the number of siblings or spouses on board (sibsp), the number of parents or children on board (parch), plus 1 (the person themselves).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"family_size"</span>] <span class="op">=</span> titanic[<span class="st">"sibsp"</span>] <span class="op">+</span> titanic[<span class="st">"parch"</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb109-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a aria-hidden="true" tabindex="-1"></a>titanic.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
</section>
<section id="boolean-and-binary-values" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="boolean-and-binary-values"><span class="header-section-number">8.3</span> Boolean and Binary Values</h2>
<p>Using the same conditions as we do when filtering we can also create Boolean (True/False) columns. This is very common practice when we want to create binary columns (which can be very useful for visualisation and analysis purposes).</p>
<section id="example-22" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="example-22"><span class="header-section-number">8.3.1</span> Example</h3>
<p>In the example below I am assigning True to all values in the age column that are under 18. My new column is called “under_18”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"under_18_bool"</span>] <span class="op">=</span> titanic[<span class="st">"age"</span>] <span class="op">&lt;</span> <span class="dv">18</span></span>
<span id="cb110-2"><a aria-hidden="true" tabindex="-1"></a>titanic.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We can also change these values from the Boolean True and False to the binary values 1 and 0, which is the key change we make when it comes to building models (it is often required that all values are numeric for example).</p>
<p>We can convert columns by using the code .astype(“int64”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"under_18_binary"</span>] <span class="op">=</span> titanic[<span class="st">"under_18_bool"</span>].astype(<span class="st">"int64"</span>)</span>
<span id="cb111-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a aria-hidden="true" tabindex="-1"></a>titanic.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
   <th style="text-align:right;"> under_18_binary </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allen, Miss. Elisabeth Walton </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 29.0000 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 24160 </td>
   <td style="text-align:right;"> 211.3375 </td>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> St Louis, MO </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Allison, Master. Hudson Trevor </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Miss. Helen Loraine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 2.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mr. Hudson Joshua Creighton </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 30.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Allison, Mrs. Hudson J C (Bessie Waldo Daniels) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 25.0000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 113781 </td>
   <td style="text-align:right;"> 151.5500 </td>
   <td style="text-align:left;"> C22 C26 </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Montreal, PQ / Chesterville, ON </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We can also do this in one step when we create the column. We can wrap the first part of the code in brackets; like our order of operations in mathematics (BIDMAS, BODMAS whatever you referred to it as) this tells Python which bit to do first.</p>
<p>In the cell below we add the new column in one line, and then sort out the missing values in the next.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add the new column and change the type in one line</span></span>
<span id="cb112-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"under_18_binary"</span>] <span class="op">=</span> (titanic[<span class="st">"age"</span>] <span class="op">&lt;</span> <span class="dv">18</span>).astype(<span class="st">"int64"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s important to note that where we have missing values, it will mark those as False (or 0). We’ll look at one way of fixing this after the exercises, but for a full look into missing values, stay tuned for Chapter 5!</p>
</section>
<section id="example-23" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="example-23"><span class="header-section-number">8.3.2</span> Example</h3>
<p>The following code uses the .isnull() method to single out where there are missing values. This is wrapped up in the indexing brackets [], so we end up with all rows containing missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a aria-hidden="true" tabindex="-1"></a>titanic[titanic[<span class="st">'age'</span>].isnull()].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
   <th style="text-align:right;"> under_18_binary </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Baumann, Mr. John D </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17318 </td>
   <td style="text-align:right;"> 25.9250 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 37 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Bradley, Mr. George ("George Arthur Brayton") </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 111427 </td>
   <td style="text-align:right;"> 26.5500 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Los Angeles, CA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Brewe, Dr. Arthur Jackson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 112379 </td>
   <td style="text-align:right;"> 39.6000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Philadelphia, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cairns, Mr. Alexander </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 113798 </td>
   <td style="text-align:right;"> 31.0000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 59 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cassebeer, Mrs. Henry Arthur Jr (Eleanor Genevieve Fosdick) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 17770 </td>
   <td style="text-align:right;"> 27.7208 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="exercise-22" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="exercise-22"><span class="header-section-number">8.3.3</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<ol type="a">
<li><p>Create a new boolean column in the animals DataFrame called fish_bool. Use the AnimalClass column to find the values that are eqivalant to Fish.</p></li>
<li><p>Convert fish_bool to a numeric column</p></li>
</ol>
</div>
<div id="tabset-13-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb114-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">"fish_bool"</span>] <span class="op">=</span> animals[<span class="st">"AnimalClass"</span>] <span class="op">==</span> <span class="st">"Fish"</span></span>
<span id="cb114-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Test if it's worked with a filter</span></span>
<span id="cb114-6"><a aria-hidden="true" tabindex="-1"></a>animals[animals[<span class="st">'AnimalClass'</span>] <span class="op">==</span> <span class="st">"Fish"</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
   <th style="text-align:left;"> attended </th>
   <th style="text-align:left;"> fish_bool </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 962 </td>
   <td style="text-align:left;"> 129048101 </td>
   <td style="text-align:left;"> 30/07/2010 21:44 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> FISH IN DANGER OF DYING IN POND </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> Lake/pond/reservoir </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Inner London </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 964 </td>
   <td style="text-align:left;"> 129261101 </td>
   <td style="text-align:left;"> 31/07/2010 06:15 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1300 </td>
   <td style="text-align:left;"> FISH IN DISTRESS, HVPU REQUIRED </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> Lake/pond/reservoir </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Inner London </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b)</span></span>
<span id="cb115-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a aria-hidden="true" tabindex="-1"></a>animals[<span class="st">"fish_bool"</span>] <span class="op">=</span> animals[<span class="st">"fish_bool"</span>].astype(<span class="st">"int64"</span>)</span>
<span id="cb115-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check with a filter</span></span>
<span id="cb115-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a aria-hidden="true" tabindex="-1"></a>animals[animals[<span class="st">"AnimalClass"</span>] <span class="op">==</span> <span class="st">"Fish"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
   <th style="text-align:left;"> attended </th>
   <th style="text-align:right;"> fish_bool </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 962 </td>
   <td style="text-align:left;"> 129048101 </td>
   <td style="text-align:left;"> 30/07/2010 21:44 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> FISH IN DANGER OF DYING IN POND </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> Lake/pond/reservoir </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Sutton </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> 00BF </td>
   <td style="text-align:left;"> Inner London </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 964 </td>
   <td style="text-align:left;"> 129261101 </td>
   <td style="text-align:left;"> 31/07/2010 06:15 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1300 </td>
   <td style="text-align:left;"> FISH IN DISTRESS, HVPU REQUIRED </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> Lake/pond/reservoir </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving livestock - Other action </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Fish </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Inner London </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</div>
</section>
<section id="more-on-the-issue-of-booleans-and-missing-values" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="more-on-the-issue-of-booleans-and-missing-values"><span class="header-section-number">8.3.4</span> More on the issue of Booleans and Missing Values</h3>
<p>Earlier we declared a boolean column that has True for under 18, and False for over 18. One issue with this method is that if an entry in the age column is a missing value (NaN) then it is classified as False here.</p>
<p>While Pandas has done exactly as we asked (it does not meet the criteria so is False) we’re artificially inflating the number of adults in our two end columns.</p>
<p>Statistically this isn’t right. There’s 263 missing values in the age column, as we don’t know the passengers age; so we should preserve the missing data types rather than assume they’re over 18 (as it currently does!)</p>
</section>
<section id="example-24" class="level3" data-number="8.3.5">
<h3 data-number="8.3.5" class="anchored" data-anchor-id="example-24"><span class="header-section-number">8.3.5</span> Example</h3>
<p>To illustrate, the cell below is filtering the titanic dataframe, showing the values that are null (using .isnull()) in the age column.</p>
<p>You can see that they show False in the under_18 column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create the "under_18" column again - in case it's not been run yet!</span></span>
<span id="cb116-2"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"under_18_bool"</span>] <span class="op">=</span> titanic[<span class="st">"age"</span>] <span class="op">&lt;</span> <span class="dv">18</span></span>
<span id="cb116-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Look at missing values in the age column</span></span>
<span id="cb116-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Note that in the "under_18" column - they are True!</span></span>
<span id="cb116-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a aria-hidden="true" tabindex="-1"></a>titanic[titanic[<span class="st">'age'</span>].isnull()].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
   <th style="text-align:right;"> under_18_binary </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Baumann, Mr. John D </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17318 </td>
   <td style="text-align:right;"> 25.9250 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 37 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Bradley, Mr. George ("George Arthur Brayton") </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 111427 </td>
   <td style="text-align:right;"> 26.5500 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Los Angeles, CA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Brewe, Dr. Arthur Jackson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 112379 </td>
   <td style="text-align:right;"> 39.6000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Philadelphia, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cairns, Mr. Alexander </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 113798 </td>
   <td style="text-align:right;"> 31.0000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 59 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cassebeer, Mrs. Henry Arthur Jr (Eleanor Genevieve Fosdick) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 17770 </td>
   <td style="text-align:right;"> 27.7208 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
</section>
<section id="example---filling-in-missing-values-with-a-constant" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="example---filling-in-missing-values-with-a-constant"><span class="header-section-number">8.4</span> Example - Filling in missing values with a constant</h2>
<p>We’ll look at more ways to action missing values in chapter 6; but for now we can use .loc[] to fill in these values. We’ll also talk about .loc[] in chapter 5 and in the extension chapter 7. Basically, .loc[] can look up rows or columns based on either their index; or as we’re doing here, a logical statement like a filter statement.</p>
<p>Here we’re using .loc[] to find rows where the age column has a null value; and updating our new column under_18 to show null (NaN) too using the keyword None. See that loc[] takes two inputs, the condition (here that is whether it is null), then the column to apply that too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a aria-hidden="true" tabindex="-1"></a>titanic.loc[titanic[<span class="st">'age'</span>].isnull(), <span class="st">'under_18_bool'</span>] <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now our NaN in age are also NaN values in under_18, as we can see if we run the cell below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a aria-hidden="true" tabindex="-1"></a>titanic[titanic[<span class="st">'age'</span>].isnull()].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
   <th style="text-align:right;"> under_18_binary </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Baumann, Mr. John D </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> PC 17318 </td>
   <td style="text-align:right;"> 25.9250 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 37 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Bradley, Mr. George ("George Arthur Brayton") </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 111427 </td>
   <td style="text-align:right;"> 26.5500 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> Los Angeles, CA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Brewe, Dr. Arthur Jackson </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 112379 </td>
   <td style="text-align:right;"> 39.6000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> Philadelphia, PA </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cairns, Mr. Alexander </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 113798 </td>
   <td style="text-align:right;"> 31.0000 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 59 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cassebeer, Mrs. Henry Arthur Jr (Eleanor Genevieve Fosdick) </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 17770 </td>
   <td style="text-align:right;"> 27.7208 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> New York, NY </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>While we still have missing data in this column that we may want to deal with later (see chapter 6); at least our “under_18” column is now more accurate. It’s really important we think about missing values whenever we perform operations using our data.</p>
<p>Even just recoding values not considered missing is a very important step when analysing and cleaning our data, as this informs us on how to treat the column.</p>
</section>
<section id="mapping-new-values" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="mapping-new-values"><span class="header-section-number">8.5</span> Mapping New Values</h2>
<p>We can also use .map() to map a dictionary to a column.</p>
<p>This can be useful when we want to explain coded variables for other users; e.g.&nbsp;the column embarked has the values S, C and Q. We can use .map() to give the full names of these ports.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"port"</span>] <span class="op">=</span> titanic[<span class="st">"embarked"</span>].<span class="bu">map</span>({<span class="st">"S"</span>:<span class="st">"Southampton"</span>,</span>
<span id="cb119-2"><a aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"C"</span>:<span class="st">"Cherbourg"</span>, </span>
<span id="cb119-3"><a aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Q"</span>: <span class="st">"Queenstown (Cobh)"</span>})</span>
<span id="cb119-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a aria-hidden="true" tabindex="-1"></a>titanic.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> pclass </th>
   <th style="text-align:right;"> survived </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:right;"> sibsp </th>
   <th style="text-align:right;"> parch </th>
   <th style="text-align:left;"> ticket </th>
   <th style="text-align:right;"> fare </th>
   <th style="text-align:left;"> cabin </th>
   <th style="text-align:left;"> embarked </th>
   <th style="text-align:left;"> home.dest </th>
   <th style="text-align:right;"> body </th>
   <th style="text-align:left;"> boat </th>
   <th style="text-align:right;"> family_size </th>
   <th style="text-align:left;"> under_18_bool </th>
   <th style="text-align:right;"> under_18_binary </th>
   <th style="text-align:left;"> port </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1305 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Zabour, Miss. Hileni </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2665 </td>
   <td style="text-align:right;"> 14.4542 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 328 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Cherbourg </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1306 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Zabour, Miss. Thamine </td>
   <td style="text-align:left;"> female </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2665 </td>
   <td style="text-align:right;"> 14.4542 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cherbourg </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1307 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Zakarian, Mr. Mapriededer </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 26.5 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2656 </td>
   <td style="text-align:right;"> 7.2250 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 304 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cherbourg </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1308 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Zakarian, Mr. Ortin </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 27.0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 2670 </td>
   <td style="text-align:right;"> 7.2250 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Cherbourg </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1309 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Zimmerman, Mr. Leo </td>
   <td style="text-align:left;"> male </td>
   <td style="text-align:right;"> 29.0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 315082 </td>
   <td style="text-align:right;"> 7.8750 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> S </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Southampton </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>The usefulness of this process cannot be overstated, many times we will be handed data in the real world that has many of these very confusing acronyms, initials etc. Recoding them to be more descriptive and easier to work with can be a lifesaver in certain situations!</p>
</section>
<section id="deleting-columns" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="deleting-columns"><span class="header-section-number">8.6</span> Deleting columns</h2>
<p>There are a few ways to remove or drop columns.</p>
<p>Let’s look at cat_dog again</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a aria-hidden="true" tabindex="-1"></a>cat_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> constant_string </th>
   <th style="text-align:right;"> constant_float </th>
   <th style="text-align:right;"> constant_int </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<section id="example-1-3" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="example-1-3"><span class="header-section-number">8.6.1</span> Example 1</h3>
<p>We have the inbuilt python statement del, which we can follow with a selected column to permanently delete it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> cat_dog[<span class="st">"constant_float"</span>]</span>
<span id="cb121-2"><a aria-hidden="true" tabindex="-1"></a>cat_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> constant_string </th>
   <th style="text-align:right;"> constant_int </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</section>
<section id="example-2-3" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="example-2-3"><span class="header-section-number">8.6.2</span> Example 2</h3>
<p>We can also use the .drop() method.</p>
<p>For Pandas version 1.4.2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a aria-hidden="true" tabindex="-1"></a>cat_dog.drop(columns <span class="op">=</span> [<span class="st">"constant_string"</span>, <span class="st">"constant_int"</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb122-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a aria-hidden="true" tabindex="-1"></a>cat_dog</span>
<span id="cb122-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># If this cell doesn't work check your version using pd.__version__</span></span>
<span id="cb122-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># If lower than 0.21.0 use the code in the text below.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> constant_string </th>
   <th style="text-align:right;"> constant_int </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> Cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> Dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> mammal </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here note:</p>
<ul>
<li>I’m passing my column names as a list, as there’s more than one</li>
<li>inplace=True updates the original Dataframe</li>
<li>For older versions of Pandas, you may need to include axis = 1 to specify that this is being applied to columns and not rows. A great example of how functions evolve over time and become streamlined.</li>
</ul>
<p><a id="merge" href=""></a></p>
</section>
</section>
</section>
<section id="merging-data" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Merging Data</h1>
<p>Let’s have a look at the two joining_data DataFrames we loaded in at the start of the chapter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a aria-hidden="true" tabindex="-1"></a>joining_data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Arf Vader </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a aria-hidden="true" tabindex="-1"></a>joining_data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> vaccinated </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spiderpig </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<ul>
<li>In joining_data1 we have the columns name, animal and age.</li>
<li>In joining_data2 we have the columns name and vaccinated.</li>
</ul>
<p>We see that Arf Vader only appears in joining_data1 and Spiderpig only appears in joining_data2. The remainder of the animals appear in both DataFrames.</p>
<section id="types-of-join" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="types-of-join"><span class="header-section-number">9.1</span> Types of Join</h2>
<p>These two DataFrames have a column in common that we could use to join them on, which is name. Without this we could not join the datasets together as this is the stipulation to perform a merge/join.</p>
<p>We can create a variety of joins. These are often best demonstrated with a Venn diagram. From here, I’m going to say that joining_data1 is my “left” DataFrame, and that joining_data2 is my “right” DataFrame.</p>
<p>For this I’m going to highlight the position of 3 animal names. As we mentioned earlier:</p>
<ul>
<li>Arf Vader is only in joining_data1, our “left” DataFrame.</li>
<li>Spiderpig is only in joining_data2, our “right” DataFrame</li>
<li>Catalie Portman is in both joining_data1 and joining_data2 and will represent values in BOTH DataFrames.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/pdmerge.png" class="img-fluid figure-img" alt="The many types of join that can be applied to dataframes."></p>
<p></p><figcaption class="figure-caption">“examples of merge”</figcaption><p></p>
</figure>
</div>
<p>As you can see left and right merges take the data from that DataFrame and any matches from the opposite one.</p>
<p>This means that in our left:</p>
<ul>
<li>Arf Vader is included because he has data in the left DataFrame.</li>
<li>Arf Vader has missing values for vaccinated, as he isn’t in that DataFame</li>
<li>`atalie Portman has data in all columns, as she appears in both the left and right</li>
<li>Spiderpig doesn’t have any data. We’re only taking data from the left, and he’s only in the right.</li>
</ul>
<section id="example-25" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="example-25"><span class="header-section-number">9.1.1</span> Example</h3>
<p>Let’s look at how we do this left merge in code. We’re going to use pd.merge() and do a left join.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a aria-hidden="true" tabindex="-1"></a>left_merge <span class="op">=</span> pd.merge(left <span class="op">=</span> joining_data1,</span>
<span id="cb125-2"><a aria-hidden="true" tabindex="-1"></a>                      right<span class="op">=</span>joining_data2, </span>
<span id="cb125-3"><a aria-hidden="true" tabindex="-1"></a>                                 how<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb125-4"><a aria-hidden="true" tabindex="-1"></a>                                 on<span class="op">=</span><span class="st">"name"</span>,</span>
<span id="cb125-5"><a aria-hidden="true" tabindex="-1"></a>                                 indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb125-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a aria-hidden="true" tabindex="-1"></a>left_merge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccinated </th>
   <th style="text-align:left;"> _merge </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> Arf Vader </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:left;"> left_only </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>This is the most layered method we have seen so far, with numerous arguments we must utilise to perform the joins we want.</p>
<ul>
<li>left = is our left hand DataFrame</li>
<li>right = is our right hand DataFrame</li>
<li>how = is how we want to perform the join, other options are
<ul>
<li>right</li>
<li>outer</li>
<li>inner (default behaviour)</li>
</ul></li>
<li>on = is the name of the column both DataFrames have in common. If we’re joining on more than one column we can specify a list here.</li>
<li>indicator set to True adds an additional column showing if the data was in the left_only, both or right_only as applicable, which is excellent for checking.</li>
</ul>
</section>
<section id="exercise-24" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="exercise-24"><span class="header-section-number">9.1.2</span> Exercise</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<ol type="a">
<li><p>Using marvel_left and marvel_right that we loaded in earlier, perform an outer join using the column name. Include the column that specifies whether they came from the left or right DataFrame.</p></li>
<li><p>Using marvel_left and marvel_right perform a left join on the column containing the years. Note that the names of these columns may not be the same in both DataFrames! (Hint: Use the help function to observe optional arguments to help with this).</p></li>
</ol>
</div>
<div id="tabset-14-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (a)</span></span>
<span id="cb126-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a aria-hidden="true" tabindex="-1"></a>marvel_outer <span class="op">=</span> marvel_left.merge(right<span class="op">=</span>marvel_right, </span>
<span id="cb126-4"><a aria-hidden="true" tabindex="-1"></a>                                 how<span class="op">=</span><span class="st">"outer"</span>,</span>
<span id="cb126-5"><a aria-hidden="true" tabindex="-1"></a>                                 on<span class="op">=</span><span class="st">"name"</span>, </span>
<span id="cb126-6"><a aria-hidden="true" tabindex="-1"></a>                                 indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb126-7"><a aria-hidden="true" tabindex="-1"></a>marvel_outer.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:right;"> year </th>
   <th style="text-align:left;"> month </th>
   <th style="text-align:right;"> worldwide_box_office </th>
   <th style="text-align:right;"> release_year </th>
   <th style="text-align:right;"> score </th>
   <th style="text-align:left;"> _merge </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 585174222 </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 93 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> June </td>
   <td style="text-align:right;"> 263427551 </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> Iron Man 2 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 623933331 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Thor </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 449326618 </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> left_only </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> Captain America: The First Avenger </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> July </td>
   <td style="text-align:right;"> 370569774 </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:left;"> both </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># (b) Using left_on and right_on since the column names are not the same in each DataFrame</span></span>
<span id="cb127-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a aria-hidden="true" tabindex="-1"></a>marvel_left_merge <span class="op">=</span> marvel_left.merge(right<span class="op">=</span>marvel_right , </span>
<span id="cb127-4"><a aria-hidden="true" tabindex="-1"></a>                                      how<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb127-5"><a aria-hidden="true" tabindex="-1"></a>                                      left_on<span class="op">=</span><span class="st">"year"</span>,</span>
<span id="cb127-6"><a aria-hidden="true" tabindex="-1"></a>                                      right_on<span class="op">=</span><span class="st">"release_year"</span>,</span>
<span id="cb127-7"><a aria-hidden="true" tabindex="-1"></a>                                      indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb127-8"><a aria-hidden="true" tabindex="-1"></a>marvel_left_merge.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name_x </th>
   <th style="text-align:right;"> year </th>
   <th style="text-align:left;"> month </th>
   <th style="text-align:right;"> worldwide_box_office </th>
   <th style="text-align:left;"> name_y </th>
   <th style="text-align:right;"> release_year </th>
   <th style="text-align:right;"> score </th>
   <th style="text-align:left;"> _merge </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 585174222 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 93 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 585174222 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> June </td>
   <td style="text-align:right;"> 263427551 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 93 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> June </td>
   <td style="text-align:right;"> 263427551 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> Iron Man 2 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 623933331 </td>
   <td style="text-align:left;"> Iron Man 2 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:left;"> both </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Notice here we use the parameter left_on to list the names of the columns in our left dataframe and right_on for the names of the columns in our right.</p>
<p>We see here that maybe the year is not the best joining column! We’re getting multiple joins for movies that have different names because we only need that “year” data to match.</p>
</div>
</div>
</div>
<p>The solution to this is to join on more than one column, which you will do next!</p>
</section>
</section>
<section id="extension-exercise" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="extension-exercise"><span class="header-section-number">9.2</span> Extension Exercise</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href=""><strong>Extension Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>Modify the join from (b) in the previous Exercise to:</p>
<ul>
<li>Join on <strong>BOTH</strong> the column containing names and the column containing years. Remember that the names may differ across the dataframes!</li>
</ul>
<p>Hint: How did we specify multiple columns in previous chapters? Remember order is important.</p>
</div>
<div id="tabset-15-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a aria-hidden="true" tabindex="-1"></a>marvel_left_merge <span class="op">=</span> marvel_left.merge(right<span class="op">=</span>marvel_right , </span>
<span id="cb128-2"><a aria-hidden="true" tabindex="-1"></a>                                      how<span class="op">=</span><span class="st">"left"</span> ,</span>
<span id="cb128-3"><a aria-hidden="true" tabindex="-1"></a>                                      left_on<span class="op">=</span>[<span class="st">"name"</span>, <span class="st">"year"</span>],</span>
<span id="cb128-4"><a aria-hidden="true" tabindex="-1"></a>                                      right_on<span class="op">=</span>[<span class="st">"name"</span>, <span class="st">"release_year"</span>],</span>
<span id="cb128-5"><a aria-hidden="true" tabindex="-1"></a>                                      indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb128-6"><a aria-hidden="true" tabindex="-1"></a>marvel_left_merge.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:right;"> year </th>
   <th style="text-align:left;"> month </th>
   <th style="text-align:right;"> worldwide_box_office </th>
   <th style="text-align:right;"> release_year </th>
   <th style="text-align:right;"> score </th>
   <th style="text-align:left;"> _merge </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Iron Man </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 585174222 </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 93 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> The Incredible Hulk </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:left;"> June </td>
   <td style="text-align:right;"> 263427551 </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> Iron Man 2 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 623933331 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:left;"> both </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Thor </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> May </td>
   <td style="text-align:right;"> 449326618 </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:right;"> NaN </td>
   <td style="text-align:left;"> left_only </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> Captain America: The First Avenger </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:left;"> July </td>
   <td style="text-align:right;"> 370569774 </td>
   <td style="text-align:right;"> 2011 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:left;"> both </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Notice here we use the parameter left_on to list the names of the columns in our left dataframe and right_on for the names of the columns in our right and as we’re using multiple columns these are in lists. This would be a great solution if we had a larger dataset to work with.</p>
<p>For example in 1998 there was a movie called “The Avengers”. It’s not a marvel movie, and does not star Iron Man, but instead Uma Thurman and Ralph Fiennes as spys! By using the name and year we’d ensure a higher level of accuracy, being as specific as you can is good.</p>
</div>
</div>
</div>
</section>
<section id="union-merge" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="union-merge"><span class="header-section-number">9.3</span> Union Merge</h2>
<p>We can also do what’s known as union merges, which is implemented using pd.concat().This is where we can add data on to the bottom of an existing dataFrame (like an appending motion).</p>
<p>It is so important that the columns of each DataFrame are in the same order, otherwise the union operation will fail (remember, columns can only have one datatype!).</p>
<section id="example-26" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="example-26"><span class="header-section-number">9.3.1</span> Example</h3>
<p>For example we have some new animals to add on to joining_data1, these are contained in the union_joined DataFrame we loaded in earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a aria-hidden="true" tabindex="-1"></a>union_joined <span class="op">=</span> pd.concat(objs<span class="op">=</span>[joining_data1, union_join_data], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb129-2"><a aria-hidden="true" tabindex="-1"></a>union_joined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Arf Vader </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Andy Warhowl </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Voldetort </td>
   <td style="text-align:left;"> tortoise </td>
   <td style="text-align:right;"> 90 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Repecka </td>
   <td style="text-align:left;"> chicken </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We can see our new additions, namely Andy Warhowl, Voldetort and Repecka here now.</p>
<p>Our parameters and arguments in pd.conact() are: * objs= - Our objects that we wish to concatenate, here as a list * ignore_index= - My new DataFrame will have it’s “own” index starting from 0. If I set this to False then I will have two things with an index of 0 and I don’t want that as this will cause frustration later!</p>
<p>This is a very rich topic (as are most processes in Pandas!) and other interesting methods exist that allow us to combine in different ways. For example, .append() and .join() also exist, here’s a link with a lot more detail about joining together data. <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">Merge, Join, Concatenate and Compare</a></p>
</section>
</section>
</section>
<section id="chapter-summary" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Chapter Summary</h1>
<p>Amazing work! Congratulations on completing Chapter 4 of the Introduction to Python Course, you are now a DataFrame Wizard!</p>
<p>In Chapter 5 we will focus on applying the various methods we covered here to clean our data, preparing it ready for the tasks that follow such as Aggregation and Summary (Chapter 6) and Visualisation (Future courses on the Learning Hub). We will cover:</p>
<ul>
<li>Copies and Views</li>
<li>Updating Values</li>
<li>Changing Column Names</li>
<li>Missing Values</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>
