<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.120">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 5 - Cleaning Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="chapter_five_cleaning_data_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter_five_cleaning_data_files/libs/quarto-html/quarto.js"></script>
<script src="chapter_five_cleaning_data_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter_five_cleaning_data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chapter_five_cleaning_data_files/libs/quarto-html/anchor.min.js"></script>
<link href="chapter_five_cleaning_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter_five_cleaning_data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chapter_five_cleaning_data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chapter_five_cleaning_data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chapter_five_cleaning_data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="chapter_five_cleaning_data_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="chapter_five_cleaning_data_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#packages-and-datasets" id="toc-packages-and-datasets" class="nav-link active" data-scroll-target="#packages-and-datasets"><span class="toc-section-number">1</span>  Packages and Datasets</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages"><span class="toc-section-number">1.1</span>  Packages</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="toc-section-number">1.2</span>  Exercise</a></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets"><span class="toc-section-number">1.3</span>  Datasets</a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="toc-section-number">1.4</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#copies-and-views" id="toc-copies-and-views" class="nav-link" data-scroll-target="#copies-and-views"><span class="toc-section-number">2</span>  Copies and Views</a>
  <ul class="collapse">
  <li><a href="#generating-a-copy" id="toc-generating-a-copy" class="nav-link" data-scroll-target="#generating-a-copy"><span class="toc-section-number">2.1</span>  Generating a Copy</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="toc-section-number">2.1.1</span>  Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="toc-section-number">2.1.2</span>  Example</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#updating-values" id="toc-updating-values" class="nav-link" data-scroll-target="#updating-values"><span class="toc-section-number">3</span>  Updating Values</a>
  <ul class="collapse">
  <li><a href="#using-.loc" id="toc-using-.loc" class="nav-link" data-scroll-target="#using-.loc"><span class="toc-section-number">3.1</span>  Using .loc[]</a>
  <ul class="collapse">
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span class="toc-section-number">3.1.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="toc-section-number">3.2</span>  Exercise</a></li>
  <li><a href="#using-.str-methods" id="toc-using-.str-methods" class="nav-link" data-scroll-target="#using-.str-methods"><span class="toc-section-number">3.3</span>  Using .str methods</a>
  <ul class="collapse">
  <li><a href="#example---lowercasing" id="toc-example---lowercasing" class="nav-link" data-scroll-target="#example---lowercasing"><span class="toc-section-number">3.3.1</span>  Example - Lowercasing</a></li>
  </ul></li>
  <li><a href="#changing-column-types" id="toc-changing-column-types" class="nav-link" data-scroll-target="#changing-column-types"><span class="toc-section-number">3.4</span>  Changing column types</a>
  <ul class="collapse">
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3"><span class="toc-section-number">3.4.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#exercise-4" id="toc-exercise-4" class="nav-link" data-scroll-target="#exercise-4"><span class="toc-section-number">3.5</span>  Exercise</a></li>
  </ul></li>
  <li><a href="#changing-column-names" id="toc-changing-column-names" class="nav-link" data-scroll-target="#changing-column-names"><span class="toc-section-number">4</span>  Changing Column Names</a>
  <ul class="collapse">
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="toc-section-number">4.1</span>  Renaming Columns</a>
  <ul class="collapse">
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4"><span class="toc-section-number">4.1.1</span>  Example</a></li>
  <li><a href="#removing-spaces" id="toc-removing-spaces" class="nav-link" data-scroll-target="#removing-spaces"><span class="toc-section-number">4.1.2</span>  Removing Spaces</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5"><span class="toc-section-number">4.1.3</span>  Example</a></li>
  <li><a href="#changing-to-lower-case" id="toc-changing-to-lower-case" class="nav-link" data-scroll-target="#changing-to-lower-case"><span class="toc-section-number">4.1.4</span>  Changing to lower case</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="toc-section-number">5</span>  Missing Values</a>
  <ul class="collapse">
  <li><a href="#what-are-mising-values" id="toc-what-are-mising-values" class="nav-link" data-scroll-target="#what-are-mising-values"><span class="toc-section-number">5.1</span>  What are mising values?</a>
  <ul class="collapse">
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6"><span class="toc-section-number">5.1.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#null-values-when-reading-in-data" id="toc-null-values-when-reading-in-data" class="nav-link" data-scroll-target="#null-values-when-reading-in-data"><span class="toc-section-number">5.2</span>  Null values when reading in data</a>
  <ul class="collapse">
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7"><span class="toc-section-number">5.2.1</span>  Example</a></li>
  </ul></li>
  <li><a href="#fixing-the-missing-value-in-place" id="toc-fixing-the-missing-value-in-place" class="nav-link" data-scroll-target="#fixing-the-missing-value-in-place"><span class="toc-section-number">5.3</span>  Fixing the missing value in place</a></li>
  <li><a href="#filling-null-values" id="toc-filling-null-values" class="nav-link" data-scroll-target="#filling-null-values"><span class="toc-section-number">5.4</span>  Filling null values</a>
  <ul class="collapse">
  <li><a href="#filling-with-a-value" id="toc-filling-with-a-value" class="nav-link" data-scroll-target="#filling-with-a-value"><span class="toc-section-number">5.4.1</span>  Filling with a value</a></li>
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8"><span class="toc-section-number">5.4.2</span>  Example</a></li>
  <li><a href="#dropping-null-values" id="toc-dropping-null-values" class="nav-link" data-scroll-target="#dropping-null-values"><span class="toc-section-number">5.4.3</span>  Dropping null values</a></li>
  <li><a href="#example-9" id="toc-example-9" class="nav-link" data-scroll-target="#example-9"><span class="toc-section-number">5.4.4</span>  Example</a></li>
  <li><a href="#dropping-duplicates" id="toc-dropping-duplicates" class="nav-link" data-scroll-target="#dropping-duplicates"><span class="toc-section-number">5.4.5</span>  Dropping Duplicates</a></li>
  <li><a href="#example-10" id="toc-example-10" class="nav-link" data-scroll-target="#example-10"><span class="toc-section-number">5.4.6</span>  Example</a></li>
  </ul></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="toc-section-number">5.5</span>  Tidy Data</a></li>
  </ul></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="toc-section-number">6</span>  Chapter Summary</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 5 - Cleaning Data</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><img src="../images/AF_DSC_banner.png" class="img-fluid" alt="Government Analysis Function and Data Science Campus Logos."></p>
<div class="cell">

</div>
<p>This is a HTML document. The Introduction to Python course is written and intended to be used in a Jupyter Notebook file. These HTML documents have been made available for users who require screen readers or other accessibility needs. These HTML documents have been tested, but if you notice any errors or any compatibility issues please contact us on the GSS Capability email inbox.</p>
<p>If you are using a screen reader you will need to set your punctuation level (sometimes called verbosity) to full, especially for the code sections.</p>
<p><em>Chapter Overview and Learning Objectives</em>:</p>
<ul>
<li><p><a href="#packages">Packages and Datasets</a></p>
<ul>
<li>Packages</li>
<li>Data</li>
</ul></li>
<li><p><a href="#copies">Copies and Views</a></p></li>
<li><p><a href="#updating_values">Updating Values</a></p>
<ul>
<li>Using .loc[]</li>
<li>Using .str methods</li>
<li>Changing column types</li>
</ul></li>
<li><p><a href="#column_names">Changing Column Names</a></p>
<ul>
<li>Changing column name values</li>
<li>Removing spaces</li>
<li>Lower Case</li>
</ul></li>
<li><p><a href="#missing">Missing Values</a></p>
<ul>
<li>What are missing values?</li>
<li>Null values when reading in data</li>
<li>Filling null values</li>
<li>Dropping null values</li>
</ul></li>
<li><p><a href="#tidy">Tidy Data</a></p></li>
</ul>
<p>This chapter covers the cleaning of our data, which is important to do as a follow up to obtaining the dataset we wish to work with (often we will view, merge etc first to obtain the full dataset we want, then start cleaning it!). Some of the concepts we introduce here are more complex than those in Chapter 4, so we wanted you to have more experience of working with Python and Pandas before we utilise them.</p>
<p><a id="packages" href=""></a></p>
<section id="packages-and-datasets" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Packages and Datasets</h1>
<section id="packages" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="packages"><span class="header-section-number">1.1</span> Packages</h2>
<p>As a reminder, we should always import our packages at the top of our script. In this session we will use pandas, and give it the nickname pd.</p>
</section>
<section id="exercise" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="exercise"><span class="header-section-number">1.2</span> Exercise</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href=""><strong>Packages</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Import Pandas and give it the nickname pd</p>
</div>
<div id="tabset-1-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="datasets" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="datasets"><span class="header-section-number">1.3</span> Datasets</h2>
<p>Good practice dictates that we should import our datasets at the top of our script too. In this session we’ll be using the following:</p>
<table class="table">
<thead>
<tr class="header">
<th>variable name</th>
<th>file name</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>animals</td>
<td>animals.csv</td>
<td></td>
</tr>
<tr class="even">
<td>titanic</td>
<td>titanic.xlsx</td>
<td></td>
</tr>
<tr class="odd">
<td>pun_animals</td>
<td>pun_animals.csv</td>
<td></td>
</tr>
</tbody>
</table>
<p>As with the previous chapter (and the next) this will also be an exercise, allowing you to practice those commands you utilise over and over when writing Python scripts.</p>
</section>
<section id="exercise-1" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">1.4</span> Exercise</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href=""><strong>Load in the Data</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Load in these datasets listed above.</p>
<p>You can check your variables are loaded by using %whos in Jupyter. In Spyder, VSCode or other IDE’s they should appear in your variable explorer.</p>
</div>
<div id="tabset-2-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a>animals <span class="op">=</span> pd.read_csv(<span class="st">"../data/animals.csv"</span>)</span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> pd.read_excel(<span class="st">"../data/titanic.xlsx"</span>)</span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals <span class="op">=</span> pd.read_csv(<span class="st">"../data/pun_animals.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Remember that Chapter 3 covered these topics in depth, so feel free to review this if you need to!</p>
</div>
</div>
</div>
<p><a id="copies" href=""></a></p>
</section>
</section>
<section id="copies-and-views" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Copies and Views</h1>
<p>It’s easy to think that the actions done so far, like filtering and copying create a brand new version of a DataFrame. However, this isn’t always the case, as sometimes they create what’s known as a <strong>view</strong> of the data.</p>
<p>In the image below, cats highlighted in red is a subset or <strong>view</strong> of the original cat_dog DataFrame, where as on the bottom it’s a new unique object called cats.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/view_copy.png" class="img-fluid figure-img" alt="An image showing views and copies and the difference between them."></p>
<p></p><figcaption class="figure-caption">an image showing views and copies</figcaption><p></p>
</figure>
</div>
<section id="generating-a-copy" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="generating-a-copy"><span class="header-section-number">2.1</span> Generating a Copy</h2>
<p>Sometimes when experimenting with code it’s desirable to create another version of our DataFrame to experiment around on. You may think this done as following process:</p>
<p>animals_new = animals</p>
<p>However this creates a view of our DataFrame, and as we’re experimenting we may not want to have our effects filter though. So how do we address this?</p>
<section id="example" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="example"><span class="header-section-number">2.1.1</span> Example</h3>
<p>We can ensure we’re working on a fresh copy of a DataFrame by using .copy() and as such, any transformations applied to this copy will not impact the original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a>animals_copy <span class="op">=</span> animals.copy() <span class="co"># The correct way to create a copy of a DataFrame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Views and copies can potentially create issues when we try and make changes to DataFrames.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/modify_view_copy.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">an image showing modifications to a copy and a view</figcaption><p></p>
</figure>
</div>
<p>Here I’m changing the name of Pico de Gato to Salsa. Pico de gallo is a kind of salsa, “gato” is Spanish for cat (The best jokes are always the ones you have to explain).</p>
<p>Depending on my desired outcome I may want my changes to apply to <strong>both</strong> cat_dog and cats, like on the top by modifying a view, or I may just want them to apply to cats by modifying a copy like on the bottom.</p>
<p>When performing these kinds of operations, you may see a “SettingWithCopyWarning” warning. This is a <strong>warning</strong>, not an error so your code will still work; but if you see this you should think about what you want the outcome to be.</p>
<p>Common reasons for this include what’s known as chained assignment.</p>
</section>
<section id="example-1" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="example-1"><span class="header-section-number">2.1.2</span> Example</h3>
<p>The cell below uses chained assignment to update the words Bull in the animals_copy DataFrame to Cow. Because this is happening in a slice, created with animals_copy[animals_copy[“AnimalGroupParent”] == “Bull”] we get this error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a>animals_copy[animals_copy[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Bull"</span>][<span class="st">"AnimalGroupParent"</span>] <span class="op">=</span> <span class="st">"cow"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy</code></pre>
</div>
</div>
<p>This suggests using .loc[] instead, which we will see in the next section. When the filter is applied to animals2 it appears as if the action has not happened. It has, but has not been applied to animals_copy, just the slice in the cell above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>animals_copy[animals_copy[<span class="st">"AnimalGroupParent"</span>]<span class="op">==</span> <span class="st">"Bull"</span>] <span class="co"># We should get 0 results here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     IncidentNumber    DateTimeOfCall  CalYear  ... AnimalClass  Code        London
1055      165500101  28/09/2010 19:17     2010  ...      Mammal  00AQ  Inner London

[1 rows x 19 columns]</code></pre>
</div>
</div>
<p>Certain methods update the <strong>original</strong> DataFrame and not a copy of it, for example .loc[], .fillna() and dropna() which we will use later. This is quite a technical element for an introduction course, so don’t worry if you don’t understand it at the moment. The fapproaches used throughout this course are considered good practice when it comes to this issue.</p>
<p>Generally speaking:</p>
<ul>
<li>All operations generate a <strong>copy</strong></li>
<li>If inplace=True is provided, it will modify in-place (updates the original); only some operations support this</li>
<li>An indexer that sets, e.g.&nbsp;.loc/.iloc/.iat/.at will set inplace.</li>
<li>An indexer that gets on a single-dtyped object is almost always a <strong>view</strong> (depending on the memory layout it may not be that’s why this is not reliable). This is mainly for efficiency. (the example from above is for .query; this will always return a copy as its evaluated by numexpr)</li>
<li>An indexer that gets on a multiple-dtyped object is always a copy. <a href="https://stackoverflow.com/questions/23296282/what-rules-does-pandas-use-to-generate-a-view-vs-a-copy">Stack Overflow Source</a></li>
</ul>
<p>This <a href="https://www.jessicayung.com/numpy-views-vs-copies-avoiding-costly-mistakes/">numpy tutorial</a> discusses copies and views in more detail. The rules for DataFrames are less explicit, but more information can be found <a href="https://www.dataquest.io/blog/settingwithcopywarning/">with this Dataquest tutorial</a></p>
<p><a id="updating_values" href=""></a></p>
</section>
</section>
</section>
<section id="updating-values" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Updating Values</h1>
<section id="using-.loc" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="using-.loc"><span class="header-section-number">3.1</span> Using .loc[]</h2>
<p>We’ve already seen one action of .loc[] when we created our new Boolean column with the missing values in Chapter 4. This very handy method for indexing can be used to access groups of rows and columns by either using labels or a Boolean array. In fact you could do any of the selection we did in Chapter 4 this way. In the <strong>Reference Material</strong> (chapter 8) we explore how to do this.</p>
<p>In this chapter we’re going to use .loc[] to update some values.</p>
<section id="example-2" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="example-2"><span class="header-section-number">3.1.1</span> Example</h3>
<p>In the cell below we’re looking at the unique values of the AnimalGroupParent column. Here we can see two values Cow and Bull that relate to the same kind of animal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>animals[(animals[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Bull"</span>) <span class="op">|</span> (animals[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Cow"</span>)].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     IncidentNumber    DateTimeOfCall  CalYear  ... AnimalClass  Code        London
1055      165500101  28/09/2010 19:17     2010  ...      Mammal  00AQ  Inner London
1104      188198101  06/11/2010 09:52     2010  ...      Mammal  00AG  Inner London
1138      207392101  09/12/2010 17:36     2010  ...      Mammal  00AR  Outer London
2215      100125121  26/08/2012 12:28     2012  ...      Mammal  00AS  Outer London
2257      113544121  19/09/2012 12:54     2012  ...      Mammal  00AR  Outer London

[5 rows x 19 columns]</code></pre>
</div>
</div>
<p>So how do we update this with .loc[]?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Update the values using .loc[]</span></span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>animals.loc[animals[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Bull"</span>, <span class="st">"AnimalGroupParent"</span>]  <span class="op">=</span> <span class="st">"Cow"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1055 </td>
   <td style="text-align:left;"> 165500101 </td>
   <td style="text-align:left;"> 28/09/2010 19:17 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 780 </td>
   <td style="text-align:left;"> LARGE BULL IN DISTRESS </td>
   <td style="text-align:left;"> Bull </td>
   <td style="text-align:left;"> Other outdoor location </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Harrow </td>
   <td style="text-align:left;"> Harrow </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AQ </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1104 </td>
   <td style="text-align:left;"> 188198101 </td>
   <td style="text-align:left;"> 06/11/2010 09:52 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 520 </td>
   <td style="text-align:left;"> SICK COW STUCK AND UNABLE TO BE RAISED </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> Barn </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Camden </td>
   <td style="text-align:left;"> Kentish Town </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1138 </td>
   <td style="text-align:left;"> 207392101 </td>
   <td style="text-align:left;"> 09/12/2010 17:36 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1560 </td>
   <td style="text-align:left;"> COW STUCK IN MUD  WATER RESCUE LEVEL  2 </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Hornchurch </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2215 </td>
   <td style="text-align:left;"> 100125121 </td>
   <td style="text-align:left;"> 26/08/2012 12:28 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> COW IN DISTRESS IN GRAND UNION CANAL </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Ruislip </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2257 </td>
   <td style="text-align:left;"> 113544121 </td>
   <td style="text-align:left;"> 19/09/2012 12:54 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> COW STUCK IN MUD </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist  trapped livestock animal </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Wennington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Notice that .loc[] takes two arguments:</p>
<ul>
<li><p>The first is my conditional look up (which the function will scan the dataframe for). In the AnimalGroupParent column of the animals DataFrame, look for the value that is “Bull”.</p></li>
<li><p>The second is the column I wish to update, here I wish to update/overwrite the column AnimalGroupParent.</p></li>
<li><p>Now that the two arguments have told .loc[] the exact value(s) we are looking for, we use = and give the new value we want to update them to; here, this is Cow.</p></li>
</ul>
<p>Let’s look at the updated DataFrame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Update the values using .loc[]</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>animals.loc[animals[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Bull"</span>, <span class="st">"AnimalGroupParent"</span>]  <span class="op">=</span> <span class="st">"Cow"</span></span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to show my new DataFrame (notice the top row was Bull and is now Cow)</span></span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a>animals[animals[<span class="st">"AnimalGroupParent"</span>] <span class="op">==</span> <span class="st">"Cow"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1055 </td>
   <td style="text-align:left;"> 165500101 </td>
   <td style="text-align:left;"> 28/09/2010 19:17 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 780 </td>
   <td style="text-align:left;"> LARGE BULL IN DISTRESS </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> Other outdoor location </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Harrow </td>
   <td style="text-align:left;"> Harrow </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AQ </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1104 </td>
   <td style="text-align:left;"> 188198101 </td>
   <td style="text-align:left;"> 06/11/2010 09:52 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 520 </td>
   <td style="text-align:left;"> SICK COW STUCK AND UNABLE TO BE RAISED </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> Barn </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance - Lift heavy livestock animal </td>
   <td style="text-align:left;"> Camden </td>
   <td style="text-align:left;"> Kentish Town </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AG </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1138 </td>
   <td style="text-align:left;"> 207392101 </td>
   <td style="text-align:left;"> 09/12/2010 17:36 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1560 </td>
   <td style="text-align:left;"> COW STUCK IN MUD  WATER RESCUE LEVEL  2 </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Hornchurch </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2215 </td>
   <td style="text-align:left;"> 100125121 </td>
   <td style="text-align:left;"> 26/08/2012 12:28 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> COW IN DISTRESS IN GRAND UNION CANAL </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Hillingdon </td>
   <td style="text-align:left;"> Ruislip </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AS </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2257 </td>
   <td style="text-align:left;"> 113544121 </td>
   <td style="text-align:left;"> 19/09/2012 12:54 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> COW STUCK IN MUD </td>
   <td style="text-align:left;"> Cow </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist  trapped livestock animal </td>
   <td style="text-align:left;"> Havering </td>
   <td style="text-align:left;"> Wennington </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AR </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We see that our first row returned has the description “Bull in distress”, which was previously Bull in AnimalGroupParent. We did this for analysis purposes so we could look at all bovine related incidents together.</p>
</section>
</section>
<section id="exercise-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">3.2</span> Exercise</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Use .loc[] to change the value Lamb to Sheep in the animals DataFrame.</p>
</div>
<div id="tabset-3-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>animals.loc[animals[<span class="st">'AnimalGroupParent'</span>] <span class="op">==</span> <span class="st">"Lamb"</span>, <span class="st">"AnimalGroupParent"</span>]  <span class="op">=</span> <span class="st">"Sheep"</span></span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to show the head of the new DataFrame </span></span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a>animals[animals[<span class="st">'AnimalGroupParent'</span>] <span class="op">==</span> <span class="st">"Sheep"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> IncidentNumber </th>
   <th style="text-align:left;"> DateTimeOfCall </th>
   <th style="text-align:right;"> CalYear </th>
   <th style="text-align:left;"> FinYear </th>
   <th style="text-align:left;"> TypeOfIncident </th>
   <th style="text-align:right;"> PumpCount </th>
   <th style="text-align:right;"> PumpHoursTotal </th>
   <th style="text-align:right;"> HourlyNominalCost(£) </th>
   <th style="text-align:right;"> IncidentNominalCost(£) </th>
   <th style="text-align:left;"> FinalDescription </th>
   <th style="text-align:left;"> AnimalGroupParent </th>
   <th style="text-align:left;"> PropertyType </th>
   <th style="text-align:left;"> SpecialServiceTypeCategory </th>
   <th style="text-align:left;"> SpecialServiceType </th>
   <th style="text-align:left;"> Borough </th>
   <th style="text-align:left;"> StnGroundName </th>
   <th style="text-align:left;"> AnimalClass </th>
   <th style="text-align:left;"> Code </th>
   <th style="text-align:left;"> London </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 105 </td>
   <td style="text-align:left;"> 44593091 </td>
   <td style="text-align:left;"> 18/03/2009 11:46 </td>
   <td style="text-align:right;"> 2009 </td>
   <td style="text-align:left;"> 2008/09 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:right;"> 255 </td>
   <td style="text-align:left;"> SHEEP IN RIVER,J15,WR1 </td>
   <td style="text-align:left;"> Sheep </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Waltham Forest </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00BH </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 776 </td>
   <td style="text-align:left;"> 72228101 </td>
   <td style="text-align:left;"> 10/05/2010 23:26 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 2010/11 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 780 </td>
   <td style="text-align:left;"> LAMB IN STREAM </td>
   <td style="text-align:left;"> Sheep </td>
   <td style="text-align:left;"> Lake/pond/reservoir </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2198 </td>
   <td style="text-align:left;"> 95952121 </td>
   <td style="text-align:left;"> 19/08/2012 17:05 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> LAMB TRAPPED IN WIRE FENCING </td>
   <td style="text-align:left;"> Sheep </td>
   <td style="text-align:left;"> Fence </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Animal assistance involving wild animal - Other action </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Chingford </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2396 </td>
   <td style="text-align:left;"> 161316121 </td>
   <td style="text-align:left;"> 25/12/2012 22:57 </td>
   <td style="text-align:right;"> 2012 </td>
   <td style="text-align:left;"> 2012/13 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:left;"> ONE SHEEP TRAPPED IN FENCING </td>
   <td style="text-align:left;"> Sheep </td>
   <td style="text-align:left;"> Animal harm outdoors </td>
   <td style="text-align:left;"> Other animal assistance </td>
   <td style="text-align:left;"> Assist  trapped livestock animal </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Inner London </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3710 </td>
   <td style="text-align:left;"> 52040151 </td>
   <td style="text-align:left;"> 29/04/2015 15:10 </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:left;"> 2015/16 </td>
   <td style="text-align:left;"> Special Service </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 596 </td>
   <td style="text-align:left;"> SHEEP TRAPPED INTO RIVER LEA </td>
   <td style="text-align:left;"> Sheep </td>
   <td style="text-align:left;"> River/canal </td>
   <td style="text-align:left;"> Animal rescue from water </td>
   <td style="text-align:left;"> Animal rescue from water - Farm animal </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Enfield </td>
   <td style="text-align:left;"> Mammal </td>
   <td style="text-align:left;"> 00AK </td>
   <td style="text-align:left;"> Outer London </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</div>
</section>
<section id="using-.str-methods" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="using-.str-methods"><span class="header-section-number">3.3</span> Using .str methods</h2>
<p>If your columns are of the object type (a.k.a strings or text values) we can manipulate these using .str methods. This is really important where our data contains the same values but different capitalisation; remember that Python would treat “Cat” and “cat” as two different values due to its case sensitive nature.</p>
<section id="example---lowercasing" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="example---lowercasing"><span class="header-section-number">3.3.1</span> Example - Lowercasing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Note the values "cat" and "Cat" both exist.</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"animal_type"</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array(['cat', 'Cat', 'dog', 'pig', 'tortoise', 'chicken'], dtype=object)</code></pre>
</div>
</div>
<p>We may want to make all of our data in pun_animals DataFrame’s animal_type column lowercase so that Python treats them as one value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Change Animal Group Parent to lower</span></span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"animal_type"</span>] <span class="op">=</span> pun_animals[<span class="st">"animal_type"</span>].<span class="bu">str</span>.lower()</span>
<span id="cb15-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># View the change by looking at the unique values</span></span>
<span id="cb15-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"animal_type"</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array(['cat', 'dog', 'pig', 'tortoise', 'chicken'], dtype=object)</code></pre>
</div>
</div>
<p>There’s a lot of other Python String methods for you to explore <a href="https://docs.python.org/2.4/lib/string-methods.html">within the python documentation</a> and many come in particularly handy when working with textual data. These take a bit of experimentation to get used to (and as such are beyond the scope of this course), but are well worth exploring.</p>
</section>
</section>
<section id="changing-column-types" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="changing-column-types"><span class="header-section-number">3.4</span> Changing column types</h2>
<p>One of the common frustrations in any programming language can be columns not being interpreted as we think they should. This was mentioned in Chapter 4 when we looked at .dtypes.</p>
<p>When we look at the .dtypes for pun_animals we can notice that all of our columns have read in as object or text values. Although, we would expect age, weight and steps_per_day to read in as numerical.</p>
<p>Python interprets these as objects because this preserves the original features of the column. This leaves how, and when, to update the column up to us.</p>
<p>In this section we’ll fix age and weight, whereas steps_per_day will be fixed in the section on missing values.</p>
<section id="example-3" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="example-3"><span class="header-section-number">3.4.1</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>name             object
animal_type      object
age              object
vaccination        bool
Steps Per Day    object
weight_kg        object
dtype: object</code></pre>
</div>
</div>
<p>Let’s start with the age column to see how this works. The process of changing the data type of a column should be thought of as a 3-step process:</p>
<ol type="1">
<li>Identify - What’s the problem with the column?</li>
<li>Fix – Update or change the values to amend the issue</li>
<li>Convert – Change the Data Type of the column.</li>
</ol>
<p>The examples we’re fixing here are simplified examples using simple data, in real world datasets there will be much more to consider, but the process is essentially the same.</p>
<p>As pun_animals is such a small DataFrame we could just print out the whole DataFrame or our affected Series to find the error. This works when we only have 10 rows of data, but would be much harder to see with 10,000 (which, remember is small in the context of real world data)!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"age"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0      3
1      5
2      1
3      7
4     11
5      6
6      4
7     12
8     90
9    One
Name: age, dtype: object</code></pre>
</div>
</div>
<p>Sometimes, for issues that permeate throughout the entire dataset, like commas in numerics (100,000) we can use methods like .head() and .tail() to <strong>identify</strong> the issue, but there are other useful methods too:</p>
<ul>
<li><p>A useful python string method is .str.isalpha() . This returns us a Boolean series, True if the string contains alphabet values (e.g a combination of A-Z) and False if it contains something else, like numeric values (e.g only the values 0-9).</p></li>
<li><p>Likewise, .str.isalnum() will return True if the string contains alphabetic or numeric values, but False if there are symbols.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"age"</span>].<span class="bu">str</span>.isalpha()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    False
1    False
2    False
3    False
4    False
5    False
6    False
7    False
8    False
9     True
Name: age, dtype: bool</code></pre>
</div>
</div>
<p>We can put this in a filter to just return the row that’s alpha and therefore “wrong”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals[pun_animals[<span class="st">"age"</span>].<span class="bu">str</span>.isalpha()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:left;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:left;"> Steps Per Day </th>
   <th style="text-align:left;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:left;"> Repecka </td>
   <td style="text-align:left;"> chicken </td>
   <td style="text-align:left;"> One </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 812 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Here the input was One as a word, which is not a numeric like the rest of the column. This completes step we as we have identified the issue.</p>
<p>Step 2 is where we fix the issue, which can be done in a variety of different ways. Here I’m going to use .loc[] but you can use .str methods too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.loc[pun_animals[<span class="st">"age"</span>] <span class="op">==</span> <span class="st">"One"</span>, <span class="st">"age"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print the Series to see the change</span></span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"age"</span>]</span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This will also work</span></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># pun_animals = pun_animals["age"].str.replace("One", "1") # Note here the "1" must be a string.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0     3
1     5
2     1
3     7
4    11
5     6
6     4
7    12
8    90
9     1
Name: age, dtype: object</code></pre>
</div>
</div>
<p>You may notice that even though we have now “fixed” the problem, the “One” is now 1 as expected, the dtype of the column is still object. Now we can move onto step 3, changing the dtype.</p>
<p>There are a few ways of converting the type. Here we’ll use pd.to_numeric() from pandas, but we can also use .astype(“int64”) that we saw in Chapter 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"age"</span>] <span class="op">=</span> pd.to_numeric(pun_animals[<span class="st">"age"</span>])</span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check out the dtypes change</span></span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"age"</span>].dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<p>Something that’s important to note here is that this conversion using pd.to_numeric() <strong>only</strong> works because we’ve already dealt with the issue in the column that was causing it to be read as an object, otherwise Python would throw an error.</p>
<p>If we try running this on the weight_kg column; we’ll get an error. This is because we’ve not fixed the problem yet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># This Cell will cause an error!</span></span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"weight_kg"</span>] <span class="op">=</span> pd.to_numeric(pun_animals[<span class="st">"weight_kg"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-4" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="exercise-4"><span class="header-section-number">3.5</span> Exercise</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href=""><strong>Exercise</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href=""><strong>Show Answer</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="unnumbered tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Change the weight_kg column to a float datatype.</p>
<p>Remember the 3 step process:</p>
<ol type="1">
<li>Identify the problem</li>
<li>Fix the problem</li>
<li>Convert the Datatype</li>
</ol>
<p>Hint: Try inverting (with a ~) the filter statement using .str.isdigit() may help you find the errant value!</p>
</div>
<div id="tabset-4-2" class="unnumbered tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Change the weight_kg column to a int datatype.</span></span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># 1 - Identify</span></span>
<span id="cb29-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pun_animals[<span class="op">~</span>pun_animals[<span class="st">"weight_kg"</span>].<span class="bu">str</span>.isdigit()])</span>
<span id="cb29-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering pun animals for the inverse (~) of the .isdigit() will return the one that is not a digit </span></span>
<span id="cb29-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># 2 - Fix  Change the "113kg" value to 113</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        name animal_type  age  vaccination Steps Per Day weight_kg
8  Voldetort    tortoise   90         True             .     113kg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.loc[pun_animals[<span class="st">"weight_kg"</span>] <span class="op">==</span> <span class="st">"113kg"</span>, <span class="st">"weight_kg"</span>] <span class="op">=</span> <span class="dv">113</span></span>
<span id="cb31-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># OR  pun_animals['weight_kg'] = pun_animals['weight_kg'].str.replace("113kg", "113")</span></span>
<span id="cb31-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a aria-hidden="true" tabindex="-1"></a><span class="co">#  Another option is replacing the letters kg with nothing (an empty string) which applies to all errant values, definitely better if there is more than one!</span></span>
<span id="cb31-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># pun_animals['weight_kg'] = pun_animals['weight_kg'].str.replace("kg", "")</span></span>
<span id="cb31-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># 3 - Convert the type</span></span>
<span id="cb31-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"weight_kg"</span>] <span class="op">=</span> pun_animals[<span class="st">"weight_kg"</span>].astype(<span class="st">"float64"</span>)</span>
<span id="cb31-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a aria-hidden="true" tabindex="-1"></a><span class="co"># OR pun_animals["weight_kg"] = pd.to_numeric(pun_animals["weight_kg"])</span></span>
<span id="cb31-14"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pun_animals[<span class="st">"weight_kg"</span>].dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>float64</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>You may get two different errors here</p>
<ul>
<li><p>Can only use .str accessor with string values, which use np.object_ dtype in pandas</p></li>
<li><p>C:-packages.py:798: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison result = getattr(x, name)(y)</p></li>
</ul>
<p>You’ve already changed the column to the numeric data type and you’re trying to run the replace values part of your code again – therefore this is failing. Try checking the datatype of your column, or searching for the error again to see if you need to do anything else.</p>
<p><a id="column_names" href=""></a></p>
</section>
</section>
<section id="changing-column-names" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Changing Column Names</h1>
<p>As we’ve seen so far Python is not particularly fussy about what our column names are; but we will often want to change them for good practice purposes and to make the cleaning process easier. In general we should have column names that:</p>
<ul>
<li>Avoid spaces (use underscores),</li>
<li>Not start with a number,</li>
<li>Remove symbols where possible,</li>
<li>Use lower case letters.</li>
</ul>
<p>Keeping a standard convention on our column names helps us as coders to remember what they are, as well as making cross compatibility with other languages easier. Some languages can be very particular about column names.</p>
<p>As we’ve seen earlier we access the columns using the .columns attribute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['name', 'animal_type', 'age', 'vaccination', 'Steps Per Day',
       'weight_kg'],
      dtype='object')</code></pre>
</div>
</div>
<section id="renaming-columns" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">4.1</span> Renaming Columns</h2>
<p>We can rename columns in a variety of ways, but here we’ll look at the .rename() method.</p>
<section id="example-4" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="example-4"><span class="header-section-number">4.1.1</span> Example</h3>
<ul>
<li><p>The parameter columns = takes a dictionary with the old name as the key and the new name as the value.</p></li>
<li><p>The parameter and argument inplace=True means that this will update the original dataframe; we don’t have to worry about putting pun_animals= at the start.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.rename(columns<span class="op">=</span>{<span class="st">"name"</span>: <span class="st">"pet_name"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> pet_name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:left;"> Steps Per Day </th>
   <th style="text-align:right;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8105 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> 611 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8161 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 7081 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Note that now if you re-run any earlier code that uses the column “name” it will bring you up a “key_error” warning as this name no longer exists, this is why doing this at the earliest opportunity is preferred to cut down on maintenance.</p>
</section>
<section id="removing-spaces" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="removing-spaces"><span class="header-section-number">4.1.2</span> Removing Spaces</h3>
<p>To remove spaces we can use the columns.str.replace() method, which takes two arguments:</p>
<ul>
<li><p>pat = - is the pattern, or thing we want to change. Note that a space is denoted by a string with a space in it, like <code>" "</code>.</p></li>
<li><p>repl = - is the replacement, or the new value we want to use. Here for example we could use an underscore (to replace a space), given as “_“.</p></li>
</ul>
</section>
<section id="example-5" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="example-5"><span class="header-section-number">4.1.3</span> Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Changing spaced column names to snake case</span></span>
<span id="cb36-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals.columns <span class="op">=</span> pun_animals.columns.<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">" "</span>, repl<span class="op">=</span><span class="st">"_"</span>)</span>
<span id="cb36-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a aria-hidden="true" tabindex="-1"></a>pun_animals.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['pet_name', 'animal_type', 'age', 'vaccination', 'Steps_Per_Day',
       'weight_kg'],
      dtype='object')</code></pre>
</div>
</div>
<p>This can also be extended by using regular expressions if you have more complicated replaces to run. Chapter 4 contains some links to regular expression guides in the filter section.</p>
<p><a id="missing" href=""></a></p>
</section>
<section id="changing-to-lower-case" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="changing-to-lower-case"><span class="header-section-number">4.1.4</span> Changing to lower case</h3>
<p>We can use other .str. methods on our columns attribute too if needed, things like .columns.str.lower() will make our column headers lower case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals.columns <span class="op">=</span> pun_animals.columns.<span class="bu">str</span>.lower()</span>
<span id="cb38-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> pet_name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:left;"> steps_per_day </th>
   <th style="text-align:right;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8105 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> 611 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8161 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 7081 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>There are packages available that will allow you to clean your column names using a single function.</p>
<p>For those of you familiar with the R statistical software package Janitor there is a Python version – <a href="https://pyjanitor.readthedocs.io/">pyjanitor</a> which has a method <a href="https://pyjanitor.readthedocs.io/reference/janitor.functions/janitor.clean_names.html#janitor.clean_names">.clean_names()</a>.</p>
<p>These packages are not included in Anaconda, so require installation.</p>
<p><a id="missing" href=""></a></p>
</section>
</section>
</section>
<section id="missing-values" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Missing Values</h1>
<section id="what-are-mising-values" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="what-are-mising-values"><span class="header-section-number">5.1</span> What are mising values?</h2>
<p>Missing (or null) values in Pandas are represented by NaN, which is an acronym for Not a Number; but pandas uses this value to represent missing values in both numeric (float) and text (object) based columns.</p>
<p>When writing code ourselves we can use the value None (a keyword so syntax highlighting comes into play) to represent missing values. Another option, if you have the Numpy package installed, is using np.nan (after “import numpy as np”) to represent missing values too.</p>
<section id="example-6" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="example-6"><span class="header-section-number">5.1.1</span> Example</h3>
<p>Let’s have a quick look at this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># First import numpy as np</span></span>
<span id="cb39-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Again "proper" convention says we should do this at the top of our code</span></span>
<span id="cb39-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># But as we're only using it for this cell, and this is a training notebook, we'll import it here</span></span>
<span id="cb39-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series with some missing values</span></span>
<span id="cb39-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Again, we usually don't create our own Series, this is for demonstration purposes only</span></span>
<span id="cb39-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a aria-hidden="true" tabindex="-1"></a>missing_series <span class="op">=</span> pd.Series([np.nan, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="va">None</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">17</span>] )</span>
<span id="cb39-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print out the missing Series</span></span>
<span id="cb39-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a aria-hidden="true" tabindex="-1"></a>missing_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0     NaN
1     4.0
2     5.0
3     5.0
4     NaN
5    12.0
6    18.0
7    17.0
dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="null-values-when-reading-in-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="null-values-when-reading-in-data"><span class="header-section-number">5.2</span> Null values when reading in data</h2>
<p>When we read in Data using the various pd.read_ methods pandas will handle some of our missing data values for us. If we look in the doc string from pd.read_csv() we can see under the na_values parameter that there are some default values that are interpreted as missing.</p>
<p>By default the following values are interpreted as NaN: ’‘,’#N/A’, ‘#N/A N/A’, ‘#NA’, ‘-1.#IND’, ‘-1.#QNAN’, ‘-NaN’, ‘-nan’, ‘1.#IND’, ‘1.#QNAN’, ‘N/A’, ‘NA’, ‘NULL’, ‘NaN’, ‘nan’.</p>
<p>If you look at the pun_animals DataFrame in Excel, you’ll see that within the column steps_per_day:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing_value.jpg" class="img-fluid figure-img" alt="Missing values from the excel spreadsheet."></p>
<p></p><figcaption class="figure-caption">missing values from excel</figcaption><p></p>
</figure>
</div>
<ul>
<li><p>Pico de Gato’s value was N/A</p></li>
<li><p>Arf Vader’s was NaN.</p></li>
<li><p>You’ll notice that a full stop . has been used to represent missing data for Voldetort.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> pet_name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:left;"> steps_per_day </th>
   <th style="text-align:right;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8105 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> 611 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 8161 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 7081 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Arf Vader </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:left;"> NaN </td>
   <td style="text-align:right;"> 16 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spiderpig </td>
   <td style="text-align:left;"> pig </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 5995 </td>
   <td style="text-align:right;"> 32 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Andy Warhowl </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 6920 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Voldetort </td>
   <td style="text-align:left;"> tortoise </td>
   <td style="text-align:right;"> 90 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> . </td>
   <td style="text-align:right;"> 113 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Repecka </td>
   <td style="text-align:left;"> chicken </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:left;"> 812 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>We see that during the read in process:</p>
<ul>
<li><p>Pico de Gato and Arf Vader have been interpreted as the missing data type “NaN”.</p></li>
<li><p>Voldetort has not, as pandas does not interpret the . automatically as a missing data type.</p></li>
<li><p>Another issue becomes apparent when we check the dtypes. The column has been interpreted an object (text); because of the full stop.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"steps_per_day"</span>].dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dtype('O')</code></pre>
</div>
</div>
<p>We now have two options:</p>
<ul>
<li>The first is telling pandas to recognise the “.” character as a null value. If we look back in the doc string at the na_values= parameter we can see that we can pass Additional strings to recognize as NA/NaN’.</li>
</ul>
<section id="example-7" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="example-7"><span class="header-section-number">5.2.1</span> Example</h3>
<p>To solve this problem, we could re-import our data like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"../data/pun_animals.csv"</span>, na_values <span class="op">=</span><span class="st">"."</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name animal_type  age  vaccination  Steps Per Day weight_kg
0   Catalie Portman         cat    3         True         8105.0         3
1      Pico de Gato         Cat    5        False            NaN         4
2         Chewbarka         dog    1        False          611.0         6
3  Sir Isaac Mewton         cat    7         True         8161.0         3
4                K9         dog   11         True         7081.0        27
5         Arf Vader         dog    6        False            NaN        16
6         Spiderpig         pig    4         True         5995.0        32
7      Andy Warhowl         dog   12         True         6920.0        27
8         Voldetort    tortoise   90         True            NaN     113kg
9           Repecka     chicken  One         True          812.0         2</code></pre>
</div>
</div>
<p>Note: Here I’m <strong>NOT</strong> assigning the output of the pd.read_csv() function to a variable. This is on purpose, so as not to overwrite the earlier cleaning we did!</p>
<p>If you want to suppress the default missing values for whatever reason the parameter keep_default_na = False also exists. If I set this as False the only things Pandas will treat as missing values are the ones we specify in na_values = . This gives us more control but is not recommended unless there are exceptional circumstances.</p>
</section>
</section>
<section id="fixing-the-missing-value-in-place" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="fixing-the-missing-value-in-place"><span class="header-section-number">5.3</span> Fixing the missing value in place</h2>
<p>The second method to correct the column is to fill and replace the value. As I’ve already done some cleaning and processing to this data, if we read the data back in, we’d have to perform this cleaning again.</p>
<p>If you know that there’s non standard missing values, it’s best to sort them out when you load in your data; but they can be handled later as well, using methods like .loc[] and then converting to a numerics with pd.to_numeric() like we’ve seen before.</p>
<p>You may notice that the columns .dtype is now float64, since older versions of Pandas do not have a missing data type for integers.</p>
<p>Panda’s has introduced a nullable integer data type from version 1.0.0. You can find more information about that version <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/integer_na.html">in this link</a> but as the majority of our learners use an older versions of Pandas we don’t cover it in this course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Correct the issue and set "." to None</span></span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals.loc[pun_animals[<span class="st">"steps_per_day"</span>] <span class="op">==</span> <span class="st">"."</span>, <span class="st">"steps_per_day"</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb46-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Convert column into numbers</span></span>
<span id="cb46-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"steps_per_day"</span>] <span class="op">=</span> pd.to_numeric(pun_animals[<span class="st">"steps_per_day"</span>])</span>
<span id="cb46-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check dytpes to see if it's worked</span></span>
<span id="cb46-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a aria-hidden="true" tabindex="-1"></a>pun_animals[<span class="st">"steps_per_day"</span>].dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
</section>
<section id="filling-null-values" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="filling-null-values"><span class="header-section-number">5.4</span> Filling null values</h2>
<section id="filling-with-a-value" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="filling-with-a-value"><span class="header-section-number">5.4.1</span> Filling with a value</h3>
<p>There’s a wide variety of approaches you may wish to take here, you can:</p>
<ul>
<li>Fill your missing values with a static number (constant).</li>
<li>Fill with a summary statistic (see Chapter 6).</li>
<li>Drop those rows from your dataframe entirely.</li>
<li>Use more advanced packages like SciPy which give functions like <a href="https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html">.interpolate()</a></li>
</ul>
<p>What you do; and how you do it should always be led by the data you have and what the best, most appropriate decision for the analysis of the data is. There is also an editing and imputation learning pathway on the Learning Hub that may help your decisions. It starts as theory based if that is what you require, building to doing the techniques taught in Python/R.</p>
<p>Let’s see some examples.</p>
</section>
<section id="example-8" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="example-8"><span class="header-section-number">5.4.2</span> Example</h3>
<p>We’re going to use the .fillna() method, which has two arguments we utilise here:</p>
<ul>
<li><p>value= is the value I wish to fill with. This can be a static value, or in this case I’m filling with the mean of the column, rounded to the nearest whole number using round() (where ndigits = is the number of decimal places to round to). We’ll look at summary statistics in more detail in Chapter 6.</p></li>
<li><p>inplace=True fills the data frame in place rather than returning a new value.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># create a copy so we're not doing this on our original data</span></span>
<span id="cb48-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals_fill <span class="op">=</span> pun_animals.copy()</span>
<span id="cb48-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create a value to fill my missing values with by rounding the mean of the steps per day column to the nearest whole number</span></span>
<span id="cb48-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a aria-hidden="true" tabindex="-1"></a>missing_puns <span class="op">=</span> <span class="bu">round</span>(number<span class="op">=</span>pun_animals_fill[<span class="st">"steps_per_day"</span>].mean(), ndigits<span class="op">=</span><span class="dv">0</span> ) <span class="co"># in later Python versions this may be digits = </span></span>
<span id="cb48-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing values</span></span>
<span id="cb48-10"><a aria-hidden="true" tabindex="-1"></a>pun_animals_fill[<span class="st">"steps_per_day"</span>].fillna(value <span class="op">=</span> missing_puns,</span>
<span id="cb48-11"><a aria-hidden="true" tabindex="-1"></a>                                         inplace<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb48-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a aria-hidden="true" tabindex="-1"></a><span class="co"># View the DataFrame</span></span>
<span id="cb48-14"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a aria-hidden="true" tabindex="-1"></a>pun_animals_fill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> pet_name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:right;"> steps_per_day </th>
   <th style="text-align:right;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 8105 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pico de Gato </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 5384 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 611 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 8161 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 7081 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Arf Vader </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 5384 </td>
   <td style="text-align:right;"> 16 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spiderpig </td>
   <td style="text-align:left;"> pig </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 5995 </td>
   <td style="text-align:right;"> 32 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Andy Warhowl </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 6920 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Voldetort </td>
   <td style="text-align:left;"> tortoise </td>
   <td style="text-align:right;"> 90 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 5384 </td>
   <td style="text-align:right;"> 113 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Repecka </td>
   <td style="text-align:left;"> chicken </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 812 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>The round() function also takes two arguments:</p>
<ul>
<li><p>The value itself we wish to round, here this is the <strong>mean</strong> of the steps_per_day column, calculated using the method .mean() which we chain to the selected column as with any other.</p></li>
<li><p>The number of digits to which to round to ndigits = (later versions may have digits =), which is an integer, 0 will give a whole number.</p></li>
</ul>
<p>Note that doing this has given the tortoise 5384 steps and although we’re not discussing the statistical implications here it’s good to highlight that this can skew your data!</p>
</section>
<section id="dropping-null-values" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="dropping-null-values"><span class="header-section-number">5.4.3</span> Dropping null values</h3>
<p>Sometimes we’ll want to drop missing values. Again as with all of the other examples, how you handle missing values should be first thought of in an analytical/statistical fashion, then enacted in python. Appropriate methods will vary depending on your data.</p>
</section>
<section id="example-9" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="example-9"><span class="header-section-number">5.4.4</span> Example</h3>
<p>We can drop missing values easily with dropna().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Make another copy of our pun_animals DataFrame</span></span>
<span id="cb49-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals_drop <span class="op">=</span> pun_animals.copy()</span>
<span id="cb49-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Drop missing rows</span></span>
<span id="cb49-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a aria-hidden="true" tabindex="-1"></a>pun_animals_drop.dropna(axis<span class="op">=</span><span class="dv">0</span>, how<span class="op">=</span><span class="st">"any"</span>, inplace<span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb49-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Show DataFrame</span></span>
<span id="cb49-10"><a aria-hidden="true" tabindex="-1"></a>pun_animals_drop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> pet_name </th>
   <th style="text-align:left;"> animal_type </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccination </th>
   <th style="text-align:right;"> steps_per_day </th>
   <th style="text-align:right;"> weight_kg </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 8105 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> Chewbarka </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> FALSE </td>
   <td style="text-align:right;"> 611 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> Sir Isaac Mewton </td>
   <td style="text-align:left;"> cat </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 8161 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 7081 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:left;"> Spiderpig </td>
   <td style="text-align:left;"> pig </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 5995 </td>
   <td style="text-align:right;"> 32 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:left;"> Andy Warhowl </td>
   <td style="text-align:left;"> dog </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 6920 </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:left;"> Repecka </td>
   <td style="text-align:left;"> chicken </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 812 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Let’s examine the paramters of .dropna()</p>
<ul>
<li><p>axis=0 will drop rows with null values.</p></li>
<li><p>how=“any” will drop a row if any value is null. We could use “all” to drop the row only if all values are missing.</p></li>
<li><p>Another commonly used parameter is subset=[column_names], often we dont need to remove all of a row because one column has missing data and we can use this to help.</p></li>
</ul>
<p>Notice that we’ve lost Pico De Gato, Voldetort and Arf Vader and that the index has not been reset. We can do this with the .reset_index() method we utilised in Chapter 4:</p>
<p>pun_animals_drop.reset_index(drop=True, inplace=True)</p>
<p><a id="tidy" href=""></a></p>
</section>
<section id="dropping-duplicates" class="level3" data-number="5.4.5">
<h3 data-number="5.4.5" class="anchored" data-anchor-id="dropping-duplicates"><span class="header-section-number">5.4.5</span> Dropping Duplicates</h3>
<p>Whilst the problem of missing values permeates throughout the cleaning routine, another similar problem (that is more hidden) is the existence of duplicate rows. Since these are not “missing”, they can be harder to spot, especially in larger datasets. As such, it is important we utilise the functions available to us to deal with them.</p>
<p>Thankfully, the issue of how to deal with these is much more straight forward, as duplicates are rarely (if ever) a good thing in our datasets, they over inflate particular categories and lead to biased outputs that are less credible. As such, it is good practice to drop them entirely.</p>
<p>The function for this is drop_duplicates() which is similar in its use and also in its parameters to dropna(), which is why it follows that subsection.</p>
</section>
<section id="example-10" class="level3" data-number="5.4.6">
<h3 data-number="5.4.6" class="anchored" data-anchor-id="example-10"><span class="header-section-number">5.4.6</span> Example</h3>
<p>To illustrate, I will create a DataFrame here, which is not something we do often but suffices for training purposes. The function drop_duplicates() will then be used to remove the duplicate row(s) from the DataFrame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create some data to show off drop_duplicates()</span></span>
<span id="cb50-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a aria-hidden="true" tabindex="-1"></a>data_with_dupes <span class="op">=</span> {</span>
<span id="cb50-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"name"</span>: [<span class="st">"Catalie Portman"</span>, <span class="st">"Andy Warhog"</span>, <span class="st">"K9"</span>, <span class="st">"Catalie Portman"</span>, <span class="st">"Andy Warhog"</span>],</span>
<span id="cb50-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"age"</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb50-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"vaccinated"</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb50-7"><a aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb50-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a aria-hidden="true" tabindex="-1"></a>pun_animals_with_duplicates <span class="op">=</span> pd.DataFrame(data_with_dupes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> name </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccinated </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Andy Warhog </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Andy Warhog </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the duplicates </span></span>
<span id="cb51-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a aria-hidden="true" tabindex="-1"></a>pun_animals_with_duplicates.drop_duplicates(inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100; "><table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> name </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> vaccinated </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> Catalie Portman </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> TRUE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> Andy Warhog </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> K9 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Like with .dropna(), this function has parameters that allow us to tweak its behaviour:</p>
<ul>
<li><p>inplace = True used above overwrites the DataFrame itself with the one that had duplicates removed.</p></li>
<li><p>subset = [colnames] allows you to specify which columns to remove duplicates in.</p></li>
</ul>
<p>More information can be found <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop_duplicates.html">here</a>.</p>
</section>
</section>
<section id="tidy-data" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">5.5</span> Tidy Data</h2>
<p>It’s estimated that Data Scientists spend 60% to 80% of their time on cleaning and preparing data. We’ve just scraped the surface of what you can do to clean your data, and we’ve used relatively simple data for these examples.</p>
<p>As you work with Python you will find new scenarios and will be able to use the tools you’ve gained in these chapters to find solutions to your problems.</p>
<p>It’s impossible to have a section of the course about tidying data without talking about tidy data. <a href="http://vita.had.co.nz/papers/tidy-data.pdf">The tidy data paper</a> by Hadley Wickham; written for the R programming language tries to provide a standard-ish way of organising data within a dataset.</p>
<p>We recommend reading the paper; as the concepts explained within are applicable across languages. An explanation of applying the practices of tidy data in Python can be found in this tutorial by <a href="https://www.jeannicholashould.com/tidy-data-in-python.html">Jean-Nicholas Hould</a>.</p>
<p><a id="END" href=""></a></p>
</section>
</section>
<section id="chapter-summary" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Chapter Summary</h1>
<p>Congratulations! You have completed Chapter 5 of the Introduction to Python Course. Messy data has nothing on your cleaning skills!</p>
<p>In Chapter 6 we will move onto Aggregation and Summary Statistics, which are the next step after cleaning our datasets (after all, the summaries we get from messy data are themselves messy!). You can look forward to:</p>
<ul>
<li>Descriptive Statistics</li>
<li>Measures of Average</li>
<li>Measures of Spread</li>
<li>Counting Values</li>
<li>Creating Size Bands</li>
<li>Aggregation and Grouping</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>
